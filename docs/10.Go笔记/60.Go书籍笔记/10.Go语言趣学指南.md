---
date: 2025-08-15 00:11:15
categories:
  - Goä¹¦ç±ç¬”è®°
tags:
  - Go
  - Goä¹¦ç±ç¬”è®°
---

# Goè¯­è¨€è¶£å­¦æŒ‡å—

## ======ã€å‘½ä»¤å¼ç¼–ç¨‹ã€‘======

## è¢«ç¾åŒ–çš„è®¡ç®—å™¨

1. **Go å¹¶ä¸æ”¯æŒ++count è¿™ç§è§è¯¸ C å’Œ Java ç­‰è¯­è¨€ä¸­çš„`å‰ç½®å¢é‡`æ“ä½œã€‚**

2. **rand åŒ…çš„ Intn()å‡½æ•°ï¼Œå­˜åœ¨â€œå·®ä¸€é”™è¯¯â€(off-by-one error)ã€‚**
   - rand.Into(10)åªä¼šè¿”å›ä¸€ä¸ª 0~9 çš„ä¼ªéšæœºæ•°
   - ä¹Ÿå°±æ˜¯è¯´è¦æƒ³ç”Ÿæˆ 1 åˆ° 10 çš„æ•°å­—ï¼Œéœ€è¦+1ã€‚å³ï¼š`var num = rand.Into(10)+1`

## å¾ªç¯å’Œåˆ†æ”¯

3. **å¯¹ Go æ¥è¯´ï¼Œtrue æ˜¯å”¯ä¸€çš„çœŸå€¼ï¼Œè€Œ false åˆ™æ˜¯å”¯ä¸€çš„å‡å€¼ã€‚**

4. **Go åªæä¾›äº†ä¸€ä¸ª`ç›¸ç­‰è¿ç®—ç¬¦`ï¼Œå¹¶ä¸”å®ƒä¸å…è®¸ç›´æ¥å°†æ–‡æœ¬å’Œæ•°å€¼è¿›è¡Œæ¯”è¾ƒã€‚**

   - ä¹Ÿå°±æ˜¯è¯´ï¼ŒGo ä¸å­˜åœ¨ä¸‰ç­‰å·è¿ç®—ç¬¦
   - "1"===1 åœ¨ Go ä¸­æŠ¥é”™ï¼Œä¸æ”¯æŒ

5. **"apple"å’Œ"banana"è¿™ä¸¤ä¸ªå•è¯ï¼Œå“ªä¸ªæ›´å¤§ä¸€äº›ï¼Ÿ**

   - `fmt.Println("apple" > "banana") // false`

6. **Go ä¹Ÿé‡‡ç”¨äº†`çŸ­è·¯é€»è¾‘`ï¼š`||`æ»¡è¶³ç¬¬ä¸€ä¸ªæ¡ä»¶ï¼Œåé¢éƒ½å¿½ç•¥ã€‚**

7. **switch è¿˜æ‹¥æœ‰ç‹¬ç‰¹çš„`fallthrough`å…³é”®å­—ï¼Œå®ƒå¯ä»¥ç”¨äºæ‰§è¡Œä¸‹ä¸€ä¸ªåˆ†æ”¯çš„ä»£ç ã€‚**

   - åœ¨ Cã€Javaã€JavaScript ç­‰è¯­è¨€ä¸­ï¼Œä¸‹é™æ˜¯ switch è¯­å¥å„ä¸ªåˆ†æ”¯çš„é»˜è®¤è¡Œä¸ºï¼Œè€Œ Go å¯¹æ­¤é‡‡å–äº†æ›´ä¸ºè°¨æ…çš„åšæ³•ï¼Œå³ç”¨æˆ·éœ€è¦æ˜¾å¼åœ°ä½¿ç”¨ fallthrough å…³é”®å­—æ‰ä¼šå¼•å‘ä¸‹é™

8. **å¸ƒå°”å€¼æ˜¯å”¯ä¸€å¯ä»¥ç”¨äºæ¡ä»¶åˆ¤æ–­çš„å€¼ã€‚**

9. **Go é€šè¿‡ ifã€switch å’Œ for æ¥å®ç°åˆ†æ”¯åˆ¤æ–­å’Œé‡å¤æ‰§è¡Œä»£ç ã€‚**

- for ç¤ºä¾‹

```go
package main

import (
 "fmt"
 "time"
)

func main() {
 var count = 10
 for count > 0 {
  fmt.Println(count)
  time.Sleep(time.Second)
  count--
 }
}
```

- if ç¤ºä¾‹

```go
package main

import (
 "fmt"
 "math/rand"
)

func main() {
 var degrees = 0
 for {
  fmt.Println(degrees)
  degrees++
  if degrees > 360 {
   degrees = 0
   if rand.Intn(2) == 0 {
    break
   }
  }
 }
}
```

- switch ç¤ºä¾‹

```go
package main

import (
 "fmt"
)

func main() {
 var word = 'b'
 switch {
 case word == 'a':
  fmt.Println("is a")
 case word == 'b':
  fmt.Println("is b")
 case word == 'c':
  fmt.Println("is c")
 }

 // ç®€åŒ–ç‰ˆ
 switch word {
 case 'a':
  fmt.Println("is a")
 case 'b':
  fmt.Println("is b")
 case 'c':
  fmt.Println("is c")
 }
}
```

## å˜é‡ä½œç”¨åŸŸ

10. **Go çš„ä½œç”¨åŸŸé€šå¸¸ä¼šéšç€å¤§æ‹¬å·`{}`çš„å‡ºç°è€Œå¼€å¯å’Œç»“æŸã€‚**

11. **è„±ç¦»ä½œç”¨åŸŸçš„å˜é‡å°†ä¸å†å¯è§å¹¶ä¸”æ— æ³•è®¿é—®ã€‚**

12. **ç®€çŸ­å£°æ˜ï¼š `var count = 0` ç­‰åŒäº `count := 0`**
    - ç®€çŸ­å£°æ˜ `:=` å¥½å¤„ï¼šåœ¨ä¸æ”¯æŒ var æƒ…å†µä¸‹ä½¿ç”¨
      - åœ¨ for å¾ªç¯ï¼Œå¾ªç¯ä½“å˜é‡ i ä½œç”¨åŸŸä¿ç•™åœ¨å¾ªç¯ä½“å†…
      - åœ¨ if è¯­å¥ä¸­å£°æ˜æ–°çš„å˜é‡
      - å’Œ if è¯­å¥ä¸€æ ·ï¼Œç®€çŸ­å£°æ˜ä¹Ÿå¯ä»¥ç”¨ä½œ switch è¯­å¥çš„ä¸€éƒ¨åˆ†

```go
for i := 0; i < 10; i++ {
  fmt.Println(i)
 }
 fmt.Println(i) // undefined: i
```

```go
if num := rand.Intn(3); num == 0 {
  fmt.Println("æ•°å­—ä¸º", num)
 } else if num == 1 {
  fmt.Println("æ•°å­—ä¸º", num)
 } else {
  fmt.Println("æ•°å­—ä¸º", num)
 }
```

```go
switch num := rand.Intn(3); num {
 case 0:
  fmt.Println("æ•°å­—ä¸º", num)
 case 1:
  fmt.Println("æ•°å­—ä¸º", num)
 case 2:
  fmt.Println("æ•°å­—ä¸º", num)
 }
```

::: tip æ³¨æ„ âš ï¸
åŒ…ä½œç”¨åŸŸåœ¨å£°æ˜å˜é‡æ—¶ä¸å…è®¸ä½¿ç”¨ç®€çŸ­å£°æ˜
:::

```go 8
package main

import (
 "fmt"
 "math/rand"
)

count := 2 // ä¸æ”¯æŒ
// syntax error: non-declaration statement outside function body

func main() {
 fmt.Println(rand.Intn(3))
}
```

13. **å‡½æ•°ä½œç”¨åŸŸæ¯”åŒ…ä½œç”¨åŸŸçš„èŒƒå›´ç‹­çª„ï¼Œå®ƒå§‹äº func å…³é”®å­—ï¼Œå¹¶ç»ˆç»“äºå‡½æ•°å£°æ˜çš„å³å¤§æ‹¬å·ã€‚**

14. **switch çš„æ¯ä¸ª case éƒ½æ‹¥æœ‰è‡ªå·±ç‹¬ç«‹çš„ä½œç”¨åŸŸï¼Œswitch åˆ†æ”¯çš„ä½œç”¨åŸŸæ˜¯å”¯ä¸€ä¸€ç§æ— é¡»ä½¿ç”¨å¤§æ‹¬å·æ ‡è¯†çš„ä½œç”¨åŸŸã€‚**

15. **åœ¨ Go è¯­è¨€ä¸­ï¼Œæ‰€æœ‰å¸¦å°æ•°ç‚¹çš„æ•°å­—åœ¨é»˜è®¤æƒ…å†µä¸‹éƒ½ä¼šè¢«è®¾ç½®ä¸º float64 ç±»å‹ã€‚**

16. **`golint`å·¥å…·èƒ½å¤Ÿæä¾›ä»£ç é£æ ¼æ–¹é¢çš„æç¤ºã€‚**

## ======ã€ç±»å‹ã€‘======

## å®æ•°

å³ï¼šå•ç²¾åº¦æµ®ç‚¹æ•°ã€åŒç²¾åº¦æµ®ç‚¹æ•°

17. **Go è¯­è¨€ä¸­ï¼Œæ‹¥æœ‰ä¸¤ç§æµ®ç‚¹ç±»å‹ï¼Œé»˜è®¤ï¼šåŒç²¾åº¦æµ®ç‚¹æ•°ï¼Œfloat64ï¼Œæ¯ä¸ªå  8 å­—èŠ‚ï¼›å•ç²¾åº¦æµ®ç‚¹æ•°ï¼Œfloat32ï¼Œæ¯ä¸ªå  4 å­—èŠ‚ï¼ˆä¹Ÿå°±æ˜¯ 32 ä½ï¼‰ã€‚**

18. **åœ¨ Go è¯­è¨€ä¸­ï¼Œæ¯ç§ç±»å‹éƒ½æœ‰ç›¸åº”çš„é»˜è®¤å€¼ï¼Œæˆ‘ä»¬å°†å…¶ç§°ä¸ºé›¶å€¼ï¼ˆzero valueï¼‰ã€‚**

    - float64 å’Œ float32 çš„é›¶å€¼éƒ½ä¸º 0.0

19. **æ‰“å°æµ®ç‚¹ç±»å‹**

| æ ¼å¼åŒ– | å®½åº¦             | ç²¾åº¦              |
| ------ | ---------------- | ----------------- |
| %v     | åŸæ ·è¾“å‡º         | åŸæ ·è¾“å‡º          |
| %f     | æ ¹æ®å®é™…æƒ…å†µ     | é»˜è®¤ä¿ç•™ 6 ä½å°æ•° |
| %.3f   | æ ¹æ®å®é™…æƒ…å†µ     | ä¿ç•™ 3 ä½å°æ•°     |
| %4.2f  | 4 ä½ï¼ŒåŒ…æ‹¬å°æ•°ç‚¹ | ä¿ç•™ 2 ä½å°æ•°     |

```go
 PI64 := math.Pi
 fmt.Println(PI64)              // 3.141592653589793
 fmt.Printf("%v\n", PI64)       // 3.141592653589793
 fmt.Printf("%f\n", PI64)       // 3.141593
 fmt.Printf("%.3f\n", PI64)     // 3.142
 fmt.Printf("%4.2f\n", PI64)    // 3.14
```

20. **0015.1021 çš„å®½åº¦å’Œç²¾åº¦åˆ†åˆ«æ˜¯å¤šå°‘ï¼Ÿ**

    - å®½åº¦ä¸º 9ï¼Œç²¾åº¦ä¸º 4ï¼Œå¹¶ä¸”ä½¿ç”¨äº†é›¶å¡«å……ï¼Œæ ¼å¼åŒ–å˜é‡ä¸º `%09.4f`

21. **æµ®ç‚¹æ•°çš„ä¸ç²¾å‡†é—®é¢˜**

æµ®ç‚¹æ•°ä¹Ÿè®¸å¹¶ä¸æ˜¯è¡¨ç¤º`é‡‘é’±`çš„æœ€ä½³é€‰æ‹©ã€‚æ­£ç¡®åšæ³•æ˜¯ä½¿ç”¨`æ•´æ•°ç±»å‹`å­˜å‚¨`ç¾åˆ†`çš„æ•°é‡

```go
 total := 1/3 + 1/3 + 1/3
 fmt.Println(1 / 3) // 0
 fmt.Println(total) // 0

 third := 1.0 / 3.0
 fmt.Println(third + third + third) // 1

 piggyBank := 0.1
 piggyBank += 0.2
 fmt.Println(piggyBank) // 0.30000000000000004
```

22. **æ¯”è¾ƒæµ®ç‚¹æ•°**

```go
 // é”™è¯¯ç¤ºèŒƒ
 piggyBank := 0.1
 piggyBank += 0.2
 fmt.Println(piggyBank == 0.3) // false

 // æ­£ç¡®ç¤ºèŒƒï¼Œæ ¹æ®è‡ªå·±çš„åº”ç”¨é€‰æ‹©ä¸€ä¸ªåˆé€‚çš„å®¹å·®
 fmt.Println(math.Abs(piggyBank-0.3) < 0.0001) // true
```

## æ•´æ•°

23. **10 ç§æ•´æ•°ç±»å‹**

- å¸¸è§„æ•´å‹ï¼šint8ã€uint8ã€int16ã€uint16ã€int32ã€uint32ã€int64ã€uint64
- ç‰¹æ®Šæ•´å‹ï¼šintã€uintï¼ˆæ ¹æ®ç›®æ ‡ç¡¬ä»¶é€‰æ‹©æœ€åˆé€‚çš„ä½é•¿ï¼‰

> int ä¸æ˜¯å…¶ä»–ä»»ä½•ç±»å‹çš„åˆ«åï¼Œintã€int32 å’Œ int64 å®é™…ä¸Šæ˜¯ 3 ç§ä¸åŒçš„ç±»å‹

24. **äº†è§£ç±»å‹**

Printf å‡½æ•°æä¾›çš„æ ¼å¼åŒ–å˜é‡`%T`å»æŸ¥çœ‹æŒ‡å®šå˜é‡çš„ç±»å‹ã€‚

```go
year := 2020
fmt.Printf("%T", year) // int
```

25. **Go è¯­è¨€ä¸­çš„åå…­è¿›åˆ¶æ•°å­—**

è¦æ±‚åå…­è¿›åˆ¶æ•°å­—å¿…é¡»å¸¦æœ‰ `0x` å‰ç¼€ã€‚

- ä½¿ç”¨ Printf å‡½æ•°æ‰“å°åå…­è¿›åˆ¶æ•°å­—ï¼šä½¿ç”¨ `%x` æˆ– `%X` ä½œä¸ºæ ¼å¼åŒ–å˜é‡

```go
var red, green, blue uint = 0, 141, 216
// åå…­è¿›åˆ¶è¡¨ç¤º
red, green, blue = 0x00, 0x8d, 0xd5
fmt.Printf("color: #%02x%02x%02x;", red, green, blue) // color: #008dd5;
```

26. **æ•´æ•°å›ç»•**

åœ¨ Go è¯­è¨€ä¸­ï¼Œå½“è¶…è¿‡æ•´æ•°ç±»å‹çš„å–å€¼èŒƒå›´æ—¶ï¼Œå°±ä¼šå‡ºç°`æ•´æ•°å›ç»•`ç°è±¡ã€‚

```go
var red uint8 = 255
red++
fmt.Println(red) // 0

var number int8 = 127
number++
fmt.Println(number) // -128
```

- æ‰“å°äºŒè¿›åˆ¶ä½

```go
var green uint8 = 3
fmt.Printf("%08b\n", green) // 00000011
green++
fmt.Printf("%08b\n", green) // 00000100
```

## å¤§æ•°

27. **big åŒ…**

big åŒ…æä¾›äº†ä»¥ä¸‹ 3 ç§ç±»å‹ã€‚

- å­˜å‚¨å¤§æ•´æ•°çš„ `big.Int`
- å­˜å‚¨ä»»æ„ç²¾åº¦æµ®ç‚¹æ•°çš„ `big.Float`
- å­˜å‚¨è¯¸å¦‚ 1/3 çš„åˆ†æ•°çš„ `big.Rat`

```go
bigNum := big.NewInt(299792)
fmt.Println(bigNum) // 299792

bigNum2 := new(big.Int)
bigNum2.SetString("24000000000000000", 10)
fmt.Println(bigNum2) // 24000000000000000
```

28. **å¸¸é‡å£°æ˜å¯ä»¥å¸¦ç±»å‹ï¼Œä½†æ— æ³•ç”¨ uint64 ç±»å‹å­˜å‚¨åƒ 24 è‰¾è¿™æ ·çš„å·¨å¤§å€¼**

- uint64 ç±»å‹æº¢å‡º

```go
const bigNum uint64 = 24000000000000000000
fmt.Println(bigNum)
// cannot use 24000000000000000000 (untyped int constant) as uint64 value in constant declaration (overflows)
```

- æ­£å¸¸

```go
const bigNum = 24000000000000000000
// èƒ½å­˜å‚¨ï¼Œä½†ä¸èƒ½æ‰“å°ï¼Œæ‰“å°è¿˜æ˜¯ä¼šæŠ¥æº¢å‡º
fmt.Println(bigNum)
// cannot use bigNum (untyped int constant 24000000000000000000) as int value in argument to fmt.Println (overflows)
```

29. **Go è¯­è¨€ä¸ä¼šä¸ºå¸¸é‡æ¨æ–­ç±»å‹ï¼Œè€Œæ˜¯ç›´æ¥å°†å…¶æ ‡è¯†ä¸º`æ— ç±»å‹ï¼ˆuntypedï¼‰`**

30. **æ— ç±»å‹å¸¸é‡å¯ä»¥å­˜å‚¨éå¸¸å¤§çš„å€¼ï¼Œå¹¶ä¸”æ‰€æœ‰æ•°å€¼å‹å­—é¢é‡éƒ½æ˜¯æ— ç±»å‹å¸¸é‡**

31. **æ— ç±»å‹å¸¸é‡åœ¨è¢«ç”¨ä½œå‡½æ•°å‚æ•°çš„æ—¶å€™ï¼Œå¿…é¡»è½¬æ¢ä¸ºæœ‰ç±»å‹å˜é‡**

## å¤šè¯­è¨€æ–‡æœ¬

32. **Go è¯­è¨€ä¼šæŠŠ `åŒå¼•å·` åŒ…å›´çš„å­—é¢å€¼æ¨æ–­ä¸º `string` ç±»å‹**

```go
// 3ç§ä½œç”¨ç­‰åŒ
peace := "peace"
var peace = "peace"
var peace string = "peace"
```

33. **ä½¿ç”¨åå¼•å·ï¼ˆ`ï¼‰åŒ…å›´çš„å­—ç¬¦ä¸²è¢«ç§°ä¸ºåŸå§‹å­—ç¬¦ä¸²å­—é¢é‡**

34. **åŸå§‹å­—ç¬¦ä¸²å­—é¢é‡å¯ä»¥åœ¨ä»£ç é‡Œé¢è·¨è¶Šå¤šä¸ªæ–‡æœ¬è¡Œ**

35. **ç±»å‹åˆ«å**

- Go è¯­è¨€æä¾›äº† runeï¼ˆç¬¦æ–‡ï¼‰ç±»å‹ç”¨äºè¡¨ç¤ºå•ä¸ªç»Ÿä¸€ç ä»£ç ç‚¹ï¼Œè¯¥ç±»å‹æ˜¯ `int32` ç±»å‹çš„åˆ«åã€‚

- Go è¯­è¨€è¿˜æä¾›äº† `uint8` ç±»å‹çš„åˆ«å `byte`

- ä» Go 1.9 å¼€å§‹ï¼Œç”¨æˆ·ä¹Ÿå¯ä»¥è‡ªè¡Œå£°æ˜ç±»å‹åˆ«åï¼Œå¦‚ï¼š

```go
type byte = uint8
type rune = int32
```

36. **å­—ç¬¦**

- æ‰“å°å­—ç¬¦ï¼šåœ¨ `Printf` ä¸­ä½¿ç”¨æ ¼å¼åŒ–å˜é‡ `%c`

- é€šè¿‡ä½¿ç”¨åˆ«å `rune` è¡¨æ˜æ•°å­—ä»£è¡¨å­—ç¬¦è€Œä¸æ˜¯æ•°å­—

- å£°æ˜ä¸€ä¸ªå­—ç¬¦å˜é‡ä¸”æ²¡æœ‰æŒ‡å®šç±»å‹ï¼ŒGo å°†æ¨æ–­è¯¥å˜é‡çš„ç±»å‹ä¸º `rune`

```go
// grade := 'A'
// var grade = 'A'
var grade rune = 'A'

fmt.Printf("%v is a %[1]T\n", grade) // 65 is a int32

var star rune = '*'
fmt.Printf("%c %[1]v\n", star) // * 42
var smile rune = 'ğŸ˜Š'
fmt.Printf("%c %[1]v\n", smile) // ğŸ˜Š 128522
```

> è™½ç„¶ rune ç±»å‹ä»£è¡¨çš„æ˜¯ä¸€ä¸ªå­—ç¬¦ï¼Œä½†å®ƒå®é™…å­˜å‚¨çš„ä»ç„¶æ˜¯æ•°å­—å€¼

37. **å­—ç¬¦ä¸²èµ‹å€¼ã€è¯»å–å•ä¸ªå­—ç¬¦**

- åŒä¸€ä¸ªå˜é‡ï¼Œå¯ä»¥èµ‹å€¼ä¸åŒå­—ç¬¦ä¸²ï¼Œä½†æ— æ³•å¯¹å­—ç¬¦ä¸²æœ¬èº«è¿›è¡Œä¿®æ”¹
- å¯ä»¥ç‹¬ç«‹è®¿é—®å­—ç¬¦ä¸²ä¸­å•ä¸ªå­—ç¬¦ï¼Œä½†æ˜¯ä¸èƒ½ä¿®æ”¹è¿™äº›å­—ç¬¦

```go
peace := "peace"
peace = "hello"
fmt.Println(peace) // hello

char := peace[1]
fmt.Printf("%c\n", char) // e

// é”™è¯¯ç¤ºèŒƒ
peace[1] = 'o'
// cannot assign to peace[1] (value of type byte)
```

38. **å°å†™å­—æ¯è½¬å¤§å†™å­—æ¯**

```go
c := 'z'
c = c - 'a' + 'A'
fmt.Printf("%c\n", c) // Z
```

39. **Go è·Ÿå¾ˆå¤šç¼–ç¨‹è¯­è¨€ä¸åŒçš„ä¸€ç‚¹åœ¨äºï¼ŒGo å…è®¸å‡½æ•°è¿”å›å¤šä¸ªå€¼**

40. **å°†å­—ç¬¦ä¸²è§£ç ä¸ºç¬¦æ–‡**

åœ¨ utf8 åŒ…ä¸­æä¾›ä»¥ä¸‹å‡½æ•°ï¼š

- `RuneCountInString` å‡½æ•°ï¼šèƒ½å¤Ÿä»¥ç¬¦æ–‡è€Œä¸æ˜¯ä»¥å­—èŠ‚ä¸ºå•ä½è¿”å›å­—ç¬¦ä¸²çš„é•¿åº¦
- `DecodeRuneInString` å‡½æ•°ï¼šèƒ½å¤Ÿè§£ç å­—ç¬¦ç”³çš„é¦–ä¸ªå­—ç¬¦å¹¶è¿”å›è§£ç åçš„ç¬¦æ–‡å ç”¨çš„å­—èŠ‚æ•°é‡ã€‚

41. **å…³é”®å­— range ä¸ä»…å¯ä»¥è¿­ä»£å„ç§ä¸åŒçš„æ”¶é›†å™¨ï¼Œè¿˜å¯ä»¥è§£ç  UTF-8 ç¼–ç çš„å­—ç¬¦ä¸²**

```go
spanish := "EspaÃ±ol"
for i, c := range spanish {
fmt.Printf("key %dï¼Œchar %c\n", i, c)
/*
key 0ï¼Œchar E
key 1ï¼Œchar s
key 2ï¼Œchar p
key 3ï¼Œchar a
key 4ï¼Œchar Ã±
key 6ï¼Œchar o
key 7ï¼Œchar l
*/
}
```

- ä¸éœ€è¦è·å–ç´¢å¼•ï¼Œä½¿ç”¨ç©ºç™½æ ‡è¯†ç¬¦\_ï¼ˆä¸‹åˆ’çº¿ï¼‰æ¥çœç•¥

```go
spanish := "EspaÃ±ol"
for _, c := range spanish {
 fmt.Printf("%c ", c) // E s p a Ã± o l
}
```

42. **å­—ç¬¦ä¸²ä½¿ç”¨ UTF-8 å¯å˜é•¿åº¦ç¼–ç ï¼Œæ¯ä¸ªå­—ç¬¦éœ€è¦å ç”¨ 1 ï½ 4 å­—èŠ‚å†…å­˜ç©ºé—´**

## ç±»å‹è½¬æ¢

43. **åœ¨ Go è¯­è¨€ä¸­ï¼Œç±»å‹ä¸èƒ½æ··åˆä½¿ç”¨**
    - å°è¯•æ‹¼æ¥æ•°å€¼å’Œå­—ç¬¦ä¸²ï¼ŒGo ç¼–è¯‘å™¨ä¼šæŠ¥ï¼šæ— æ•ˆæ“ä½œ
    - å°è¯•æ‹¼æ¥æ•°å€¼å’Œæµ®ç‚¹ç±»å‹ï¼ŒGo ç¼–è¯‘å™¨ä¼šæŠ¥ï¼šæ— æ•ˆæ“ä½œ

> Go ä¸ä¼šå¯¹ä½ çš„æ„å›¾åšä»»ä½•å‡è®¾ï¼Œä½ å¿…é¡»é€šè¿‡æ˜¾å¼çš„ç±»å‹è½¬æ¢æ¥è§£å†³è¿™ä¸ªé—®é¢˜

```go
countdown := "abc" + 10 + "def"
fmt.Println(countdown)
// invalid operation
```

44. **æ•°å­—ç±»å‹è½¬æ¢**

- æ•´å‹è½¬æµ®ç‚¹å‹

```go
age := 30
marsAge := float64(age)
fmt.Printf("%v %[1]T\n", marsAge) // 30 float64
```

- æµ®ç‚¹å‹è½¬æ•´å‹

ã€æ³¨æ„ã€‘æµ®ç‚¹æ•°å°æ•°ç‚¹ä¹‹åçš„æ•°å­—å°†ç›´æ¥è¢« `æˆªæ–­` è€Œä¸ä¼šåšä»»ä½•èˆå…¥

```go
marsNumber := 30.8
number := int(marsNumber)
fmt.Printf("%v %[1]T\n", number) // 30 int
```

45. **math åŒ…æä¾›çš„æœ€å°å¸¸é‡å’Œæœ€å¤§å¸¸é‡**

```go
var num int32 = 16161616
if num < math.MinInt16 || num > math.MaxInt16 {
    // å¤„ç†è¶…å‡ºèŒƒå›´çš„å€¼
}
```

46. **å­—ç¬¦ä¸²è½¬æ¢ï¼šstrconv.Itoa å‡½æ•°å’Œ fmt.Sprintf å‡½æ•°**

- ä½¿ç”¨ strconv åŒ…çš„ Itoa å‡½æ•°è½¬æ¢

```go
countdown := 10
str := strconv.Itoa(countdown) + "ç§’åï¼Œç³»ç»Ÿå…³æœºï¼"
fmt.Println(str) // 10ç§’åï¼Œç³»ç»Ÿå…³æœºï¼
```

- ä½¿ç”¨ fmt åŒ…çš„ Sprintf å‡½æ•°è½¬æ¢

```go
countdown := 10
str := fmt.Sprintf("%vç§’åï¼Œç³»ç»Ÿå…³æœºï¼", countdown)
fmt.Println(str) // 10ç§’åï¼Œç³»ç»Ÿå…³æœºï¼
```

47. **é™æ€ç±»å‹**

å˜é‡ä¸€æ—¦è¢«å£°æ˜ï¼Œå®ƒå°±æœ‰äº†ç±»å‹å¹¶ä¸”æ— æ³•æ”¹å˜å®ƒçš„ç±»å‹ã€‚è¿™ç§æœºåˆ¶è¢«ç§°ä¸º `é™æ€ç±»å‹`

48. **è½¬æ¢å¸ƒå°”å€¼**

- é€šè¿‡ Sprintf å‡½æ•°å°†å¸ƒå°”å€¼å˜é‡è½¬æ¢æˆæ–‡æœ¬

```go
launch := false
launchText := fmt.Sprintf("%v", launch)
fmt.Println(launchText) // false
```

- å°†å­—ç¬¦ä¸²è½¬æ¢ä¸ºå¸ƒå°”å€¼

```go
yesNo := "no"
launch := (yesNo == "yes")
fmt.Println(launch) // false
```

::: tip æ³¨æ„
åœ¨ Go è¯­è¨€ä¸­ï¼Œæ²¡æœ‰æ•°å­— 0 å’Œç©ºå­—ç¬¦ä¸²""æ¥è¡¨ç¤º falseï¼Œæ²¡æœ‰æ•°å­— 1 å’Œéç©ºå­—ç¬¦ä¸²è¡¨ç¤º true

å› æ­¤ï¼Œä¸‹è¿°éƒ½æ˜¯éæ³•çš„ï¼š  
string(false)ã€int(false)ã€bool(1)ã€bool("yes")ï¼ŒGo ç¼–è¯‘å™¨éƒ½ä¼šæŠ¥å‘Šé”™è¯¯
:::

## ======ã€æ„å»ºå—ã€‘======

## å‡½æ•°

49. **å‡½æ•°å£°æ˜**

åœ¨ Go ä¸­ï¼Œä»¥ `å¤§å†™å­—æ¯å¼€å¤´` çš„å‡½æ•°ã€å˜é‡ä»¥åŠå…¶ä»–æ ‡è¯†ç¬¦éƒ½ä¼šè¢«å¯¼å‡ºå¹¶å¯¹å…¶ä»–åŒ…å¯ç”¨ï¼Œåä¹‹åˆ™ä¸ç„¶

- å¦‚æœå¤šä¸ªå½¢å‚æ‹¥æœ‰ç›¸åŒçš„ç±»å‹ï¼Œé‚£ä¹ˆæˆ‘ä»¬åªéœ€è¦æŠŠè¿™ä¸ªç±»å‹å†™å‡ºæ¥ä¸€æ¬¡å³å¯ï¼š

```go
func Unix(sec int64, nsec int64) Time
func Unix(sec, nsec int64) Time
```

- å¤šä¸ªè¿”å›å€¼

```go
// å¤šä¸ªè¿”å›å€¼ï¼Œéœ€è¦æ‹¬å·åŒ…å›´èµ·æ¥
func Atoi(s string) (i int, err error)
// è¿”å›å€¼å»æ‰åå­—ï¼Œåªä¿ç•™ç±»å‹
func Atoi(s string) (int, error)
```

50. **å‡½æ•°å£°æ˜ä¸­çš„çœç•¥å·...ä»£è¡¨ä»€ä¹ˆæ„æ€ï¼Ÿ**

å‡½æ•°å£°æ˜ä¸­å¸¦æœ‰çœç•¥å·...æ„å‘³ç€è¯¥å‡½æ•°æ˜¯ä¸€ä¸ªå¯å˜å‚æ•°å‡½æ•°ï¼Œå®ƒå¯ä»¥æ¥å—ä»»æ„å¤šä¸ªå®å‚

## æ–¹æ³•

51. **é€šè¿‡æ–¹æ³•ä¸ºç±»å‹æ·»åŠ è¡Œä¸º**

æ¯ä¸ªæ–¹æ³•å’Œå‡½æ•°éƒ½å¯ä»¥æ¥å—å¤šä¸ªå½¢å‚ï¼Œä½†ä¸€ä¸ªæ–¹æ³•å¿…é¡»å¹¶ä¸”åªèƒ½æœ‰ä¸€ä¸ªæ¥æ”¶è€…

è·Ÿè°ƒç”¨å…¶ä»–åŒ…ä¸­çš„å‡½æ•°ä¸€æ ·ï¼Œè°ƒç”¨æ–¹æ³•ä¹Ÿéœ€è¦ç”¨åˆ° `ç‚¹è®°å·`

## ä¸€ç­‰å‡½æ•°

52. **åŒ¿åå‡½æ•°ä¹Ÿå°±æ˜¯æ²¡æœ‰åå­—çš„å‡½æ•°ï¼Œå† Go ä¸­ä¹Ÿè¢«ç§°ä¸ºå‡½æ•°å­—é¢é‡ã€‚**
    - å› ä¸ºå‡½æ•°å­—é¢é‡éœ€è¦ä¿ç•™å¤–éƒ¨ä½œç”¨åŸŸçš„å˜é‡å¼•ç”¨ï¼Œæ‰€ä»¥å‡½æ•°å­—é¢é‡éƒ½æ˜¯é—­åŒ…çš„

```go
package main

import "fmt"

var f = func() {
 fmt.Println("Hello World")
}

func main() {
 f()
}
```

- é—­åŒ…ä¿ç•™çš„äº‹å‘¨å›´å˜é‡çš„å¼•ç”¨è€Œä¸æ˜¯å‰¯æœ¬å€¼ï¼Œæ‰€ä»¥ä¿®æ”¹è¢«é—­åŒ…æ•è·çš„å˜é‡å¯èƒ½ä¼šå¯¼è‡´è°ƒç”¨åŒ¿åå‡½æ•°çš„ç»“æœå‘ç”Ÿå˜åŒ–

```go
package main

import "fmt"

var k = 294.0

func main() {
 sensor := func() float64 {
  return k
 }

 fmt.Println(sensor()) // 294
 k++
 fmt.Println(sensor()) // 295
}
```

53. **é—­åŒ…æä¾›äº†å“ªäº›æ™®é€šå‡½æ•°ä¸å…·å¤‡çš„ç‰¹æ€§ï¼Ÿ**

é—­åŒ…èƒ½å¤Ÿä¿ç•™å¤–éƒ¨ä½œç”¨åŸŸçš„å˜é‡å¼•ç”¨

## ======ã€æ”¶é›†å™¨ã€‘======

## åŠ³è‹¦åŠŸé«˜çš„æ•°ç»„

54. **ä½¿ç”¨å¤åˆå­—é¢é‡åˆå§‹åŒ–æ•°ç»„**

Go è¯­è¨€çš„å¤åˆå­—é¢é‡è¯­æ³•å…è®¸æˆ‘ä»¬åœ¨å•ä¸ªæ­¥éª¤é‡Œé¢å®Œæˆå£°æ˜æ•°ç»„å’Œåˆå§‹åŒ–æ•°ç»„è¿™ä¸¤é¡¹å·¥ä½œ

```go
array := [5]string{"a", "b", "c", "d", "e"}
fmt.Println(array) // [a b c d e]
```

- ä½¿ç”¨çœç•¥å·...è®© Go ç¼–è¯‘å™¨è®¡ç®—æ•°ç»„å…ƒç´ çš„æ•°é‡

```go
array := [...]string{
 "a",
 "b",
 "c",
 "d",
 "e",
}
fmt.Println(array)      // [a b c d e]
fmt.Println(len(array)) // 5
```

55. **è¿­ä»£æ•°ç»„**

- æ ¹æ®ä¸‹æ ‡è®¿é—®

```go
array := [...]string{"a", "b", "c"}
for i := 0; i < len(array); i++ {
 fmt.Println(array[i])
}
```

- ä½¿ç”¨å…³é”®å­— range è¿­ä»£æ•°ç»„

```go
array := [...]string{"a", "b", "c"}
for i, item := range array {
 fmt.Println(i, item)
}
```

56. **æ•°ç»„è¢«å¤åˆ¶**

æ— è®ºæ˜¯å°†æ•°ç»„èµ‹å€¼ç»™æ–°çš„å˜é‡è¿˜æ˜¯å°†å®ƒä¼ é€’ç»™å‡½æ•°ï¼Œéƒ½ä¼šäº§ç”Ÿä¸€ä¸ªå®Œæ•´çš„æ•°ç»„å‰¯æœ¬

```go
array := [...]string{"a", "b", "c"}
newArray := array
array[1] = "o"
fmt.Println(array)    // [a o c]
fmt.Println(newArray) // [a b c]
```

57. **å°è¯•ä¼ é€’é•¿åº¦ä¸ç›¸ç¬¦çš„æ•°ç»„ä½œä¸ºå‚æ•°å°†å¯¼è‡´ Go ç¼–è¯‘å™¨æŠ¥é”™**

## åˆ‡ç‰‡ï¼šæŒ‡å‘æ•°ç»„çš„çª—å£

::: tip åˆ‡ç‰‡çš„å®šä¹‰
æ¯ä¸ªåˆ‡ç‰‡åœ¨å†…éƒ¨éƒ½ä¼šè¢«è¡¨ç¤ºä¸ºä¸€ä¸ªåŒ…å« 3 ä¸ªå…ƒç´ çš„ç»“æ„ï¼Œè¿™ 3 ä¸ªå…ƒç´ åˆ†åˆ«æ˜¯æŒ‡å‘æ•°ç»„çš„æŒ‡é’ˆã€åˆ‡ç‰‡çš„å®¹é‡ä»¥åŠåˆ‡ç‰‡çš„é•¿åº¦ã€‚
:::

58. **åˆ‡åˆ†æ•°ç»„**

- é€šè¿‡åˆ‡åˆ†æ•°ç»„åˆ›å»ºåˆ‡ç‰‡éœ€è¦ç”¨åˆ° `åŠå¼€åŒºé—´` ï¼ˆåŒ…æ‹¬å·¦è¾¹å¼€å§‹ç´¢å¼•ï¼Œä¸åŒ…æ‹¬ç»“æŸç´¢å¼•ï¼‰

- é™¤å¯ä»¥åˆ›å»ºæ•°ç»„çš„åˆ‡ç‰‡ä¹‹å¤–ï¼Œè¿˜å¯ä»¥åˆ›å»ºåˆ‡ç‰‡çš„åˆ‡ç‰‡

```go
array := [...]string{"a", "b", "c", "d", "e", "f", "g"}
aArray := array[2:5]
bArray := aArray[0:2]
cArray := aArray[1:2]
fmt.Println(aArray, bArray, cArray) // [c d e] [c d] [d]
```

- åˆ‡ç‰‡çš„é»˜è®¤ç´¢å¼•

```go
array := [...]string{"a", "b", "c", "d", "e", "f", "g"}
aArray := array[2:5]
bArray := aArray[:2]                // çœç•¥å¼€å§‹ç´¢å¼•ï¼Œåˆ™ä½¿ç”¨èµ·å§‹ä½ç½®
cArray := aArray[2:]                // çœç•¥ç»“æŸç´¢å¼•ï¼Œåˆ™ä½¿ç”¨æ•°ç»„é•¿åº¦
fmt.Println(aArray, bArray, cArray) // [c d e] [c d] [d]
```

- åŒæ—¶çœç•¥èµ·å§‹å’Œç»“æŸç´¢å¼•

```go
dArray := aArray[:]
fmt.Println(dArray) // [c d e]
```

- åˆ‡ç‰‡çš„ç´¢å¼•ä¸èƒ½æ˜¯è´Ÿæ•°

59. **åˆ‡åˆ†å­—ç¬¦ä¸²**

- åˆ‡åˆ†å­—ç¬¦ä¸²å°†åˆ›å»ºå¦ä¸€ä¸ªå­—ç¬¦ä¸²
- åˆ‡åˆ†å­—ç¬¦ä¸²æ—¶ï¼Œç´¢å¼•ä»£è¡¨çš„æ˜¯å­—èŠ‚å·ç è€Œéç¬¦æ–‡å·ç 

```go
name := "hello world"
subName := name[5:]
name = "my time"
fmt.Println(name, subName) // my time  world
```

60. **Go è¯­è¨€çš„è®¸å¤šå‡½æ•°éƒ½å€¾å‘äºä½¿ç”¨åˆ‡ç‰‡è€Œä¸æ˜¯æ•°ç»„ä½œä¸ºè¾“å…¥**

    - Go è¯­è¨€çš„ä½¿ç”¨è€…å¾ˆå°‘ä¼šç›´æ¥ä½¿ç”¨æ•°ç»„ï¼Œå®ƒä»¬æ›´æ„¿æ„ä½¿ç”¨æ›´ä¸ºé€šç”¨çš„åˆ‡ç‰‡ï¼Œç‰¹åˆ«æ˜¯åœ¨å‘å‡½æ•°ä¼ é€’å®å‚çš„æ—¶å€™ã€‚

61. **å£°æ˜ä¸€ä¸ªå­—ç¬¦ä¸²åˆ‡ç‰‡ï¼Œåªéœ€è¦ä½¿ç”¨ `[]string` ä½œä¸ºç±»å‹å³å¯**

```go
dwarfs := []string{"a", "b", "c", "d", "e"}
fmt.Println(dwarfs)        // [a b c d e]
fmt.Printf("%T\n", dwarfs) // []string
```

62. **åœ¨ Go è¯­è¨€ä¸­ï¼Œå½“ä½ å°†åˆ‡ç‰‡ï¼ˆsliceï¼‰ä¼ é€’ç»™å‡½æ•°æ—¶ï¼Œå®é™…ä¸Šæ˜¯åœ¨è¿›è¡Œ `â€œä¼ å€â€` æ“ä½œã€‚è¿™æ˜¯å› ä¸ºåˆ‡ç‰‡åœ¨ Go ä¸­æ˜¯ä¸€ä¸ª `å¼•ç”¨ç±»å‹` ï¼Œå®ƒåŒ…å«æŒ‡å‘åº•å±‚æ•°ç»„çš„æŒ‡é’ˆã€é•¿åº¦å’Œå®¹é‡ä¿¡æ¯ã€‚**
    - åˆ‡ç‰‡æ˜¯æŒ‡å‘æ•°ç»„çš„çª—å£å’Œè§†å›¾
    - åˆ‡ç‰‡åœ¨èµ‹å€¼æˆ–è€…ä¼ é€’è‡³å‡½æ•°æ—¶ï¼Œå°†ä¸æ–°å˜é‡å…±äº«ç›¸åŒçš„åº•å±‚æ•°æ®

```go
package main

import (
 "fmt"
 "strings"
)

func handleSlice(data []string) {
 for i, v := range data {
  data[i] = strings.TrimSpace(v)
 }
}

func main() {
 dwarfs := []string{"a ", " b", " c "}
 handleSlice(dwarfs)
 fmt.Println(strings.Join(dwarfs, "")) // abc
}
```

## æ›´å¤§çš„åˆ‡ç‰‡

63. **append å‡½æ•°**

- å’Œ Println ä¸€æ ·ï¼Œappend ä¹Ÿæ˜¯ä¸€ä¸ªå¯å˜å‚æ•°å‡½æ•°ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥ä¸€æ¬¡å‘åˆ‡ç‰‡è¿½åŠ å¤šä¸ªå…ƒç´ 

```go
dwarfs := []string{"a", "b", "c"}
dwarfs = append(dwarfs, "d", "e")
fmt.Println(dwarfs) // [a b c d e]
```

- ä¸‰ç´¢å¼•åˆ‡ç‰‡æ“ä½œ

```go 3,5,6
planets := []string{"a", "b", "c", "d", "e", "f", "g", "h", "i", "j"}
terrestrial := planets[0:4:4]
fmt.Println(len(terrestrial), cap(terrestrial)) // 4 4
worlds := append(terrestrial, "k")
fmt.Println(worlds)  // [a b c d k]
fmt.Println(planets) // [a b c d e f g h i j]
```

- ä¸ä½¿ç”¨ä¸‰ç´¢å¼•åˆ‡ç‰‡æ“ä½œ

```go 3,5,6
planets := []string{"a", "b", "c", "d", "e", "f", "g", "h", "i", "j"}
terrestrial := planets[0:4]
fmt.Println(len(terrestrial), cap(terrestrial)) // 4 10
worlds := append(terrestrial, "k")
fmt.Println(worlds)  // [a b c d k]
fmt.Println(planets) // [a b c d k f g h i j]
```

64. **ä½¿ç”¨ `makeå‡½æ•°` å¯¹åˆ‡ç‰‡å®è¡Œé¢„åˆ†é…**

å½“åˆ‡ç‰‡çš„å®¹é‡ä¸è¶³ä»¥æ‰§è¡Œ append æ“ä½œæ—¶ï¼ŒGo å¿…é¡»åˆ›å»ºæ–°æ•°ç»„å¹¶å¤åˆ¶æ—§æ•°ç»„ä¸­çš„å†…å®¹ã€‚

```go
dwarfs := make([]string, 0, 10)
fmt.Println(len(dwarfs), cap(dwarfs)) // 0 10
dwarfs = append(dwarfs, "a", "b", "c", "d", "e", "f", "g", "h", "i", "j")
fmt.Println(dwarfs)                   // [a b c d e f g h i j]
fmt.Println(len(dwarfs), cap(dwarfs)) // 10 10
dwarfs = append(dwarfs, "k")
fmt.Println(dwarfs)                   // [a b c d e f g h i j k]
fmt.Println(len(dwarfs), cap(dwarfs)) // 11 20
```

65. **å£°æ˜å¯å˜å‚æ•°å‡½æ•°**

```go
package main

import "fmt"

func handleData(prefix string, worlds ...string) []string {
 newWorlds := make([]string, len(worlds))
 for i := range worlds {
  newWorlds[i] = prefix + " " + worlds[i]
 }
 return newWorlds
}

func main() {
 twoWorlds := handleData("new", "abc", "xyz")
 fmt.Println(twoWorlds) // [new abc new xyz]
}
```

- é€šè¿‡çœç•¥å·å¯ä»¥ `å±•å¼€` åˆ‡ç‰‡ä¸­çš„å¤šä¸ªå…ƒç´ ï¼Œå¹¶å°†å®ƒä»¬ç”¨ä½œä¼ é€’ç»™å‡½æ•°çš„å¤šä¸ªå®å‚

```go
planets := []string{"a", "b", "c"}
twoWorlds := handleData("new", planets...)
fmt.Println(twoWorlds) // [new a new b new c]
```

## æ— æ‰€ä¸èƒ½çš„æ˜ å°„

66. **å£°æ˜æ˜ å°„**

æ˜ å°„çš„é”®å‡ ä¹å¯ä»¥æ˜¯ä»»ä½•ç±»å‹ã€‚

åœ¨ä½¿ç”¨ Go è¯­è¨€çš„æ˜ å°„æ—¶ï¼Œæˆ‘ä»¬å¿…é¡»ä¸ºæ˜ å°„çš„é”®å’Œå€¼æŒ‡å®šç±»å‹

ä¸¾ä¾‹ï¼š `map[string]int`

å…¶ä¸­ï¼šstring ä¸ºé”®çš„ç±»å‹ï¼Œint ä¸ºå€¼çš„ç±»å‹

```go
temperature := map[string]int{
 "Earth": 15,
 "Mars":  -65,
}
temp := temperature["Earth"]
fmt.Println(temp) // 15
```

- å¦‚æœç¨‹åºè®¿é—®çš„é”®å¹¶ä¸å­˜åœ¨äºæ˜ å°„ä¸­ï¼Œé‚£ä¹ˆ Go è¯­è¨€å°†æ ¹æ®å€¼çš„ç±»å‹è¿”å›ç›¸åº”çš„é›¶å€¼ä½œä¸ºç»“æœ

```go
fmt.Println(temperature["other"]) // 0
```

- Go è¯­è¨€æä¾›äº†â€œé€—å·ä¸ okâ€è¯­æ³•

åŒºåˆ†é”®å­˜åœ¨äºæ˜ å°„ä¸­ï¼Œä»¥åŠæœ¬èº«å€¼ä¸º 0ï¼ˆæ­¤å¤„æ‹¿ int ç±»å‹ä¸¾ä¾‹ï¼‰

```go
if moon, ok := temperature["moon"]; ok {
 fmt.Println(moon)
} else {
 fmt.Println("No moon") // No moon
}
```

> ç¬¬äºŒä¸ªå˜é‡ï¼Œä¸å±€é™äº okï¼Œå¯ä»¥è‡ªç”±åœ°ä»»æ„åå­—å‘½åï¼Œå¦‚ï¼šmoon, found

67. **æ˜ å°„å…±äº«ç›¸åŒçš„åº•å±‚æ•°æ®ï¼Œä¿®æ”¹ä»»æ„ä¸€ä¸ªéƒ½å°†å¯¼è‡´å¦ä¸€ä¸ªå‘ç”Ÿå˜åŒ–**

```go
temperature := map[string]int{
 "Earth": 15,
 "Mars":  -65,
}

twoTemperature := temperature

temperature["Earth"] = 30
fmt.Println(temperature)    // map[Earth:30 Mars:-65]
fmt.Println(twoTemperature) // map[Earth:30 Mars:-65]

delete(twoTemperature, "Earth")
fmt.Println(twoTemperature) // map[Mars:-65]
fmt.Println(temperature)    // map[Mars:-65]
```

68. **ä½¿ç”¨ make å‡½æ•°å¯¹æ˜ å°„å®è¡Œé¢„åˆ†é…**

```go
temperature := make(map[string]int, 8)
fmt.Println(temperature, len(temperature)) // map[] 0
```

69. **range åœ¨æ¯æ¬¡è¿­ä»£æ˜ å°„æ—¶æä¾›çš„å°†ä¸å†æ˜¯ç´¢å¼•å’Œå€¼ï¼Œè€Œæ˜¯é”®å’Œå€¼**

70. **Go åœ¨è¿­ä»£æ˜ å°„æ—¶å¹¶ä¸ä¿è¯é”®çš„é¡ºåºï¼Œå› æ­¤ï¼ŒåŒæ ·çš„æ˜ å°„åœ¨è¿›è¡Œå¤šæ¬¡è¿­ä»£æ—¶å¯èƒ½ä¼šäº§ç”Ÿä¸åŒçš„è¾“å‡º**

71. **ä½¿ç”¨æ˜ å°„å’Œåˆ‡ç‰‡å®ç°æ•°æ®åˆ†ç»„**

- ä»¥æ¯ 10â„ƒ ä¸ºä¸€ç»„å¯¹æ¸©åº¦å®è¡Œåˆ†ç»„

```go
temperatures := []float64{
 -28.0, 32.0, -31.0, -29.0, -23.0, -29.0, -28.0, -33.0,
}

groups := make(map[float64][]float64)

for _, t := range temperatures {
 g := math.Trunc(t/10) * 10
 groups[g] = append(groups[g], t)
}

for g, temperatures := range groups {
 fmt.Printf("%v : %v\n", g, temperatures)
}
/*
 30 : [32]
 -30 : [-31 -33]
 -20 : [-28 -29 -23 -29 -28]
*/
```

72. **å°†æ˜ å°„ç”¨ä½œé›†åˆ**

é›†åˆä¿è¯å…¶ä¸­çš„æ¯ä¸ªå…ƒç´ åªä¼šå‡ºç°ä¸€æ¬¡ã€‚

Go è¯­è¨€æ²¡æœ‰ç›´æ¥æä¾›é›†åˆæ”¶é›†å™¨

- é€šè¿‡æ˜ å°„æ”¹è‰¯æˆé›†åˆ

```go
temperatures := []float64{
 -28.0, 32.0, -31.0, -29.0, -23.0, -29.0, -28.0, -33.0,
}

set := make(map[float64]bool)

for _, t := range temperatures {
 set[t] = true
}

fmt.Println(set) // map[-33:true -31:true -29:true -28:true -23:true 32:true]

if set[-28.0] {
 fmt.Println("å­˜åœ¨-28.0") // è¾“å‡ºï¼šå­˜åœ¨-28.0
}
```

- å¯¹é›†åˆè½¬æˆåˆ‡ç‰‡æ’åº

```go
unique := make([]float64, 0, len(set))
for t := range set {
 unique = append(unique, t)
}

sort.Float64s(unique)
fmt.Println(unique) // [-33 -31 -29 -28 -23 32]
```

## ======ã€çŠ¶æ€ä¸è¡Œä¸ºã€‘======

## ç»“æ„

73. **å£°æ˜ç»“æ„**

åœ¨ç»“æ„ä¸­ï¼Œè®¿é—®å­—æ®µçš„å€¼æˆ–è€…ä¸ºå­—æ®µèµ‹å€¼éƒ½éœ€è¦ç”¨åˆ° `ç‚¹æ ‡è®°æ³•`

```go
package main

import "fmt"

var curiosity struct {
 lat float64
 lon float64
}

func main() {
 curiosity.lat = -4.5895
 curiosity.lon = 137.4417

 fmt.Println(curiosity.lon, curiosity.lat) // 137.4417 -4.5895
 fmt.Println(curiosity)                    // {-4.5895 137.4417}
}
```

74. **é€šè¿‡ç±»å‹å¤ç”¨ç»“æ„**

```go
package main

import "fmt"

type curiosity struct {
 lat float64
 lon float64
}

func main() {
 var spirit curiosity
 spirit.lat = -14.5684
 spirit.lon = 175.472636

 var spirit2 curiosity
 spirit2.lat = -1.9462
 spirit2.lon = 354.4734

 fmt.Println(spirit, spirit2) // {-14.5684 175.472636} {-1.9462 354.4734}
}
```

75. **é€šè¿‡å¤åˆå­—é¢é‡åˆå§‹åŒ–ç»“æ„**

åˆå§‹åŒ–å¯ä»¥æŒ‰ä»»ä½•é¡ºåºç»™å®šå­—æ®µèµ‹å€¼ï¼Œæ²¡æœ‰èµ‹å€¼çš„ä¼šè¢«åˆå§‹åŒ–ä¸ºç±»å‹å¯¹åº”çš„é›¶å€¼

```go
package main

import "fmt"

type location struct {
 lat, lon float64
}

func main() {
 myLocation := location{lon: 354.4734, lat: -1.9462}
 fmt.Println(myLocation) // {-1.9462 354.4734}
}
```

76. **åªä½¿ç”¨å€¼è¿›è¡Œåˆå§‹åŒ–çš„å¤åˆå­—é¢é‡**

```go
package main

import "fmt"

type location struct {
 lat, lon float64
}

func main() {
 myLocation := location{-1.9462, 354.4734}
 fmt.Println(myLocation.lat) // -1.9462
 fmt.Println(myLocation.lon) // 354.4734
}
```

77. **æ‰“å°å‡ºç»“æ„çš„å­—æ®µ**

```go
package main

import "fmt"

type location struct {
 lat, lon float64
}

func main() {
 myLocation := location{-1.9462, 354.4734}
 fmt.Printf("%v\n", myLocation)  // {-1.9462 354.4734}
 fmt.Printf("%+v\n", myLocation) // {lat:-1.9462 lon:354.4734}
}
```

78. **ç»“æ„è¢«å¤åˆ¶**

ä¸¤ä¸ªç»“æ„å‘ç”Ÿçš„å˜åŒ–ä¸ä¼šå¯¹å¯¹æ–¹äº§ç”Ÿä»»ä½•å½±å“

```go
myLocation := location{-1.9462, 354.4734}
otherLocation := myLocation

otherLocation.lon += 0.0106

fmt.Println(myLocation)    // {-1.9462 354.4734}
fmt.Println(otherLocation) // {-1.9462 354.48400000000004}
```

79. **ç”±ç»“æ„ç»„æˆçš„åˆ‡ç‰‡**

`[]struct` ç”¨äºè¡¨ç¤ºç”±ç»“æ„ç»„æˆçš„åˆ‡ç‰‡ï¼Œå®ƒçš„ç‹¬ç‰¹ä¹‹å¤„åœ¨äºï¼Œåˆ‡ç‰‡åŒ…å«çš„æ¯ä¸ªå€¼éƒ½æ˜¯ä¸€ä¸ªç»“æ„è€Œä¸æ˜¯åƒ float64 è¿™æ ·çš„åŸºæœ¬ç±»å‹

```go
package main

import "fmt"

type location struct {
 name string
 lat  float64
 lon  float64
}

func main() {
 locations := []location{
  {name: "abc", lat: 1, lon: 1},
  {name: "edf", lat: 2, lon: 2},
  {name: "ghi", lat: 3, lon: 3},
 }
 fmt.Println(locations) // [{abc 1 1} {edf 2 2} {ghi 3 3}]
}
```

80. **å°†ç»“æ„ç¼–ç ä¸º json**

- æ¥è‡ª json åŒ…çš„ Marshal å‡½æ•°å°†æŒ‡å®šæ•°æ®ç¼–ç ä¸º JSON æ ¼å¼ï¼Œå¹¶ä»¥å­—èŠ‚å½¢å¼è¿”å›ç¼–ç åçš„ JSON æ•°æ®

- ç»“æ„ä¸­å­—æ®µå¿…é¡»ä»¥å¤§å†™å­—æ¯å¼€å¤´ï¼ˆMarshal å‡½æ•°åªä¼šå¯¹ç»“æ„ä¸­è¢«å¯¼å‡ºçš„å­—æ®µå®æ–½ç¼–ç ï¼‰

> æ¢å¥è¯è¯´ï¼Œå¦‚æœå­—æ®µéƒ½æ˜¯ä»¥å°å†™å­—æ¯å¼€å¤´ï¼Œé‚£ä¹ˆç¼–ç çš„ç»“æœå°†ä¼šæ˜¯{}

```go
package main

import (
 "encoding/json"
 "fmt"
 "os"
)

func main() {
 type location struct {
  Lat, Lon float64
 }

 data := location{1, 1}
 bytes, err := json.Marshal(data)
 exitOnError(err)
 fmt.Println(string(bytes)) // {"Lat":1,"Lon":1}
}

func exitOnError(err error) {
 if err != nil {
  fmt.Println(err)
  os.Exit(1)
 }
}
```

81. **ä½¿ç”¨ç»“æ„æ ‡ç­¾å®šåˆ¶ JSON**

Go è¦æ±‚ç»“æ„ä¸­çš„å­—æ®µå¿…é¡»æ˜¯å¤§å†™å­—æ¯å¼€å¤´ï¼Œå¹¶ä¸”å¤šä¸ªå•è¯å­—æ®µåç§°å¿…é¡»ä½¿ç”¨ç±»ä¼¼ CaselCase è¿™æ ·çš„é©¼å³°å½¢å‘½åæƒ¯ä¾‹

ä¸ºäº†æŒ‰ç…§æˆ‘ä»¬çš„æ„æ„¿ä¿®æ”¹å­—æ®µåç§°ï¼Œå¯ä»¥ç»™ç»“æ„ä¸­çš„å­—æ®µæ‰“æ ‡ç­¾ï¼ˆtagï¼‰

```go 2-3
type location struct {
  Lat float64 `json:"lat"`
  Lon float64 `json:"lon"`
 }

 data := location{1, 1}
 bytes, err := json.Marshal(data)
 exitOnError(err)
 fmt.Println(string(bytes)) // {"lat":1,"lon":1}
```

> ä¸Šé¢ä¹‹æ‰€ä»¥ä½¿ç”¨``è€Œä¸æ˜¯ä½¿ç”¨""ï¼Œç›®çš„æ˜¯çœä¸‹ä½¿ç”¨åæ–œæ è½¬ç§»""çš„åŠŸå¤«è€Œå·²ã€‚  
> åŒå¼•å·å†™æ³•ï¼š"json:\\"lat\\""

## Go æ²¡æœ‰ç±»

Go è¯­è¨€è·Ÿä¼ ç»Ÿç¼–ç¨‹è¯­è¨€ä¸ä¸€æ ·ï¼Œå®ƒæ—¢ä¸æ”¯æŒç±»å’Œå¯¹è±¡ï¼Œä¹Ÿä¸æ”¯æŒç»§æ‰¿

ä¸è¿‡ï¼ŒGo è¯­è¨€æä¾›äº†ç»“æ„å’Œæ–¹æ³•ï¼Œé€šè¿‡ç»„åˆä¸¤è€…å°±å¯ä»¥å®ç°é¢å‘å¯¹è±¡è®¾è®¡çš„ç›¸å…³æ¦‚å¿µ

82. **æ„é€ å‡½æ•°**

- Go è¯­è¨€å¹¶æ²¡æœ‰ä¸ºæ„é€ å™¨æä¾›ç‰¹æ®Šçš„è¯­è¨€ç‰¹æ€§ï¼Œè€Œæ˜¯é€‰æ‹©äº†åç§°æ ¼å¼ä¸º `newType` æˆ–è€… `NewType` çš„å‡½æ•°ç”¨äºæ„é€ æŒ‡å®šç±»å‹çš„å€¼ï¼Œè‡³äºå‡½æ•°åé¦–å­—æ¯çš„å¤§å°å†™åˆ™ç”±å‡½æ•°æ˜¯å¦éœ€è¦å¯¼å‡ºä»¥ä¾›å…¶ä»–åŒ…ä½¿ç”¨æ¥å†³å®šã€‚

- ä¸€äº›å¯¹å¤–æä¾›ä½¿ç”¨çš„åŒ…ï¼Œå°†æ„é€ å‡½æ•°å‘½åä¸º New å‡½æ•°ï¼Œæ›´ç®€æ´ã€‚ä¾‹å¦‚ï¼šerrors åŒ…å°±æ˜¯è¿™æ ·ï¼Œerrors.New()

- åœ¨ Go è¯­è¨€ä¸­ï¼Œæ„é€ å‡½æ•°å’Œå…¶ä»–å‡½æ•°ä¸€æ ·åªæ˜¯æ™®é€šçš„å‡½æ•°ã€‚

## ç»„åˆä¸è½¬å‘

83. **åˆå¹¶ç»“æ„**

```go
package main

import "fmt"

type report struct {
 sol         int
 temperature temperature
 location    location
}

type temperature struct {
 high, low celsius
}

type location struct {
 lat, long float64
}

type celsius float64

func (t temperature) average() celsius {
 return (t.high + t.low) / 2.0
}

// æ–¹æ³•è½¬å‘ï¼ˆreportè½¬å‘è‡³temperatureæ–¹æ³•ï¼‰
func (r report) average() celsius {
 return r.temperature.average()
}

func main() {
 bradbury := location{-4.5895, 137.4417}
 t := temperature{high: -1.0, low: -78.0}
 report := report{sol: 15, temperature: t, location: bradbury}

 fmt.Printf("%+v\n", report)
 // {sol:15 temperature:{high:-1 low:-78} location:{lat:-4.5895 long:137.4417}}
 fmt.Printf("%v\n", report.temperature.high) // -1

 fmt.Printf("average: %v\n", t.average())                  // average: -39.5
 fmt.Printf("average: %v\n", report.temperature.average()) // average: -39.5

 fmt.Printf("average: %v\n", report.average()) // average: -39.5
}
```

84. **å®ç°è‡ªåŠ¨çš„è½¬å‘æ–¹æ³•**

```go
package main

import "fmt"

type report struct {
 sol int
 temperature
 location
}

type temperature struct {
 high, low celsius
}

type location struct {
 lat, long float64
}

type celsius float64

func (t temperature) average() celsius {
 return (t.high + t.low) / 2.0
}

func (r report) average() celsius {
 return r.temperature.average()
}

func main() {
 report := report{
  sol:         15,
  temperature: temperature{high: -1.0, low: -78.0},
  location:    location{-4.5895, 137.4417},
 }

 fmt.Printf("average: %vâ„ƒ\n", report.average())             // average: -39.5â„ƒ
 fmt.Printf("average: %vâ„ƒ\n", report.temperature.average()) // average: -39.5â„ƒ
 fmt.Printf("%vâ„ƒ\n", report.high)                           // -1â„ƒ
 report.high = 32
 fmt.Printf("%vâ„ƒ\n", report.temperature.high) // 32â„ƒ
}

```

85. **å‘½åå†²çª**

```go
package main

import "fmt"

type sol int

type report struct {
 sol
 temperature
 location
}

type temperature struct {
 high, low float64
}

type location struct {
 lat, long float64
}

func (s sol) days(s2 sol) int {
 days := int(s2 - s)
 if days < 0 {
  days = -days
 }
 return days
}

func (l location) days(l2 location) int {
 return 5
}

/*
æ³¨é‡Šæ­¤æ–¹æ³•ï¼Œreport.days(1446)ä¼šæŠ¥â€œä¸æ˜ç¡®çš„å¼•ç”¨ 'days'â€
reportç±»å‹çš„åŒåæ–¹æ³•ä¼˜å…ˆçº§é«˜äºåµŒå…¥ç±»å‹çš„å…¶ä»–åŒåæ–¹æ³•ã€‚
*/
func (r report) days(s2 sol) int {
 return r.sol.days(s2)
}


func main() {
 report := report{sol: 15}

 fmt.Println(report.sol.days(1446)) // 1431
 fmt.Println(report.days(1446))     // 1431
}
```

86. **Go å¹¶æ²¡æœ‰æä¾›å§”æ‰˜æˆ–è€…ç»§æ‰¿**

## æ¥å£

- æ¥å£ç±»å‹é€šè¿‡ä¸€ç»„æ–¹æ³•æ¥æŒ‡å®šæ‰€éœ€çš„è¡Œä¸º
- ä»»ä½•åŒ…ä¸­çš„æ–°ä»£ç æˆ–è€…å·²æœ‰ä»£ç éƒ½å¯ä»¥éšå¼åœ°æ»¡è¶³æ¥å£
- ç»“æ„å¯ä»¥é€šè¿‡åµŒå…¥æ»¡è¶³æ¥å£çš„ç±»å‹æ¥æ»¡è¶³æ¥å£

87. **æ¥å£ç±»å‹**

```go
package main

import (
 "fmt"
 "strings"
)

var t interface {
 talk() string
}

type martian struct {
}

func (m martian) talk() string {
 return "martian"
}

type laser int

func (l laser) talk() string {
 return strings.Repeat("pew ", int(l))
}

func main() {
 t = martian{}
 fmt.Println(t.talk()) // martian

 t = laser(3)
 fmt.Println(t.talk()) // pew pew pew
}
```

> æ¥å£é€šè¿‡ `å¤šæ€` è®©å˜é‡ t å…·å¤‡äº†â€œå¤šç§å½¢æ€â€

88. **ä¸ºäº†ä¾¿äºå¤ç”¨ï¼Œæˆ‘ä»¬é€šå¸¸ä¼šæŠŠæ¥å£å£°æ˜ä¸ºç±»å‹å¹¶ä¸ºå…¶å‘½åã€‚æŒ‰ç…§æƒ¯ä¾‹ï¼Œæ¥å£ç±»å‹çš„åç§°å¸¸å¸¸ä¼šä»¥ `-er` ä½œä¸ºåç¼€**

```go
type talker interface {
 talk() string
}
```

89. **Go è¯­è¨€å…è®¸åœ¨å®ç°ä»£ç çš„è¿‡ç¨‹ä¸­éšæ—¶åˆ›å»ºæ–°çš„æ¥å£ã€‚ä»»ä½•ä»£ç éƒ½å¯ä»¥å®ç°æ¥å£ï¼ŒåŒ…æ‹¬é‚£äº›å·²ç»å­˜åœ¨çš„ä»£ç **

90. **Go è¯­è¨€çš„æ¥å£éƒ½æ˜¯éšå¼æ»¡è¶³çš„**

- éšå¼æ»¡è¶³æ¥å£æœ‰ä»€ä¹ˆå¥½å¤„ï¼Ÿ

ä½ å£°æ˜çš„æ¥å£å¯ä»¥ç”±å…¶ä»–äººç¼–å†™çš„ä»£ç æ¥æ»¡è¶³ï¼Œè¿™ç§åšæ³•èƒ½å¤Ÿè®©ä»£ç å˜å¾—æ›´åŠ çµæ´»ã€‚

91. **æ»¡è¶³æ¥å£**

Go æ ‡å‡†åº“å¯¼å‡ºäº†å¾ˆå¤šåªæœ‰å•ä¸ªæ–¹æ³•çš„æ¥å£ï¼Œäººä»¬å¯ä»¥åœ¨è‡ªå·±çš„ä»£ç ä¸­å®ç°å®ƒä»¬ã€‚

## ======ã€æ·±å…¥ GO è¯­è¨€ã€‘======

## å…³äºæŒ‡é’ˆçš„äºŒä¸‰äº‹

92. **æŒ‡é’ˆ**

æŒ‡é’ˆæ˜¯æŒ‡å‘å¦ä¸€å˜é‡çš„åœ°å€çš„å˜é‡

æŒ‡é’ˆæ˜¯`é—´æ¥è®¿é—®`çš„ä¸€ç§å½¢å¼

Go çš„æŒ‡é’ˆé‡‡ç”¨äº†å†å²æ‚ ä¹…å¹¶ä¸”å¹¿ä¸ºäººçŸ¥çš„ C è¯­è¨€æŒ‡é’ˆè¯­æ³•

- å˜é‡ä¼šå°†å®ƒä»¬çš„å€¼å­˜å‚¨åœ¨è®¡ç®—æœºçš„éšæœºè®¿é—®å­˜å‚¨å™¨é‡Œé¢ï¼Œè€Œå€¼çš„å­˜å‚¨ä½ç½®åˆ™æ˜¯è¯¥å˜é‡çš„å†…å­˜åœ°å€ã€‚

### åœ°å€æ“ä½œç¬¦ï¼ˆ&ï¼‰ï¼šé€šè¿‡ä½¿ç”¨&è¡¨ç¤ºçš„åœ°å€æ“ä½œç¬¦ï¼Œæˆ‘ä»¬å¯ä»¥å¾—åˆ°æŒ‡å®šå˜é‡çš„å†…å­˜åœ°å€

```go
answer := 30
fmt.Println(&answer) // 0x1400011a018
```

### è§£å¼•ç”¨æ“ä½œç¬¦ï¼ˆ\*ï¼‰ï¼šæä¾›å†…å­˜åœ°å€æŒ‡å‘çš„å€¼

```go
address := &answer
fmt.Println(*address) // 30
```

::: tip æ³¨æ„
C è¯­è¨€ä¸­çš„å†…å­˜åœ°å€å¯ä»¥é€šè¿‡è¯¸å¦‚ address++è¿™æ ·çš„æŒ‡é’ˆè¿ç®—è¿›è¡Œæ“ä½œï¼Œä½† Go è¯­è¨€ä¸å…è®¸è¿™ç§ä¸å®‰å…¨çš„æ“ä½œ
:::

93. **æŒ‡é’ˆç±»å‹**

\*int ä¸­çš„æ˜Ÿå·è¡¨ç¤ºè¿™æ˜¯ä¸€ç§æŒ‡é’ˆç±»å‹ã€‚

```go
canada := "canada"

var home *string
fmt.Printf("%T\n", home) // *string

home = &canada
fmt.Printf(*home) // canada
```

94. **æŒ‡é’ˆçš„ä½œç”¨å°±æ˜¯æŒ‡å‘**

æŠŠè§£å¼•ç”¨çš„ç»“æœèµ‹å€¼ç»™å¦ä¸€ä¸ªå˜é‡å°†äº§ç”Ÿä¸€ä¸ªå­—ç¬¦ä¸²å‰¯æœ¬ã€‚

95. **æŒ‡å‘ç»“æ„çš„æŒ‡é’ˆ**

```go
package main

import "fmt"

type person struct {
 name, superpower string
 age              int
}

func main() {
 timmy := &person{
  name: "Timmy",
  age:  10,
 }
 fmt.Println(timmy) // &{Timmy  10}
 fmt.Println((*timmy).name) // Timmy
}
```

åœ¨è®¿é—®å­—æ®µæ—¶å¯¹ç»“æ„è¿›è¡Œè§£å¼•ç”¨å¹¶ä¸æ˜¯å¿…éœ€çš„

```go
timmy.superpower = "flying"
fmt.Printf("%+v\n", timmy) // &{name:Timmy superpower:flying age:10}
```

**è¯­æ³• timmy.superpower å’Œ (\*timmy).superpower æœ‰ä½•åŒºåˆ«ï¼Ÿ**

å› ä¸º Go ä¼šä¸ºå­—æ®µè‡ªåŠ¨å®æ–½æŒ‡é’ˆè§£å¼•ç”¨ï¼Œæ‰€ä»¥ä¸Šè¿°ä¸¤ä¸ªè¯­å¥åœ¨åŠŸèƒ½ä¸Šæ²¡æœ‰ä»»ä½•åŒºåˆ«ï¼Œä¸è¿‡ç”±äº timmy.superpower æ›´æ˜“è¯»ï¼Œå› æ­¤å®ƒæ›´å¯å–ä¸€äº›ã€‚

96. **æŒ‡å‘æ•°ç»„çš„æŒ‡é’ˆ**

Go ä¹Ÿä¸ºæ•°ç»„æä¾›äº†è‡ªåŠ¨çš„è§£å¼•ç”¨ç‰¹æ€§ã€‚

```go
timmy := &[3]string{"Timmy1", "Timmy2", "Timmy3"}
fmt.Println(timmy[0])   // Timmy1
fmt.Println(timmy[1:2]) // [Timmy2]
```

97. **åˆ‡ç‰‡å’Œæ˜ å°„çš„å¤åˆå­—é¢é‡å‰é¢ä¹Ÿå¯ä»¥æ”¾ç½®åœ°å€æ“ä½œç¬¦ï¼ˆ&ï¼‰ï¼Œä½† Go è¯­è¨€å¹¶æ²¡æœ‰ä¸ºå®ƒä»¬æä¾›è‡ªåŠ¨çš„è§£å¼•ç”¨ç‰¹æ€§**

98. **å°†æŒ‡é’ˆç”¨ä½œå½¢å‚**

```go
package main

import "fmt"

type person struct {
 name, superpower string
 age              int
}

func birthday(p *person) {
 p.age++
}

func main() {
 timmy := person{
  name:       "Timmy",
  superpower: "image",
  age:        18,
 }
 birthday(&timmy)
 fmt.Println(timmy) // {Timmy image 19}
}
```

99. **æŒ‡é’ˆæ¥æ”¶è€…**

- ä½¿ç”¨æŒ‡é’ˆæ‰§è¡Œæ–¹æ³•è°ƒç”¨

```go
package main

import "fmt"

type person struct {
 name string
 age  int
}

func (p *person) birthday() {
 p.age++
}

func main() {
 timmy := &person{
  name: "Timmy",
  age:  18,
 }
 timmy.birthday()
 fmt.Printf("%+v\n", timmy) // &{name:Timmy age:19}
}
```

- æ— é¡»æŒ‡é’ˆæ‰§è¡Œæ–¹æ³•è°ƒç”¨

```go
package main

import "fmt"

type person struct {
 name string
 age  int
}

func (p *person) birthday() {
 p.age++
}

func main() {
 timmy := person{
  name: "Timmy",
  age:  18,
 }
 timmy.birthday()
 fmt.Printf("%+v\n", timmy) // {name:Timmy age:19}
}
```

> æ— è®ºè°ƒç”¨æ–¹æ³•çš„å˜é‡æ˜¯å¦ä¸ºæŒ‡é’ˆï¼Œ`birthday` æ–¹æ³•éƒ½å¿…é¡»ä½¿ç”¨ `æŒ‡é’ˆ` ä½œä¸º `æ¥æ”¶è€…`ï¼Œå¦åˆ™ age å­—æ®µå°†æ— æ³•å®ç°è‡ªå¢

100. **å†…éƒ¨æŒ‡é’ˆ**

å†…éƒ¨æŒ‡é’ˆå³æ˜¯æŒ‡å‘ç»“æ„å†…éƒ¨å­—æ®µçš„æŒ‡é’ˆã€‚è¿™ä¸€ç‚¹å¯ä»¥é€šè¿‡åœ¨ç»“æ„å­—æ®µçš„å‰é¢æ”¾ç½®åœ°å€æ“ä½œç¬¦æ¥å®Œæˆï¼Œå¦‚&player.stats

- levelUp å‡½æ•°å¯¹ stats ç»“æ„è¿›è¡Œä¿®æ”¹ï¼Œæ‰€ä»¥å®ƒéœ€è¦å°†å½¢å‚è®¾ç½®ä¸ºæŒ‡é’ˆç±»å‹

```go
package main

import "fmt"

type stats struct {
 level             int
 endurance, health int
}

func levelUp(s *stats) {
 s.level++
 s.endurance = 18 + (14 * s.level)
 s.health = 5 * s.endurance
}

func main() {
 myStats := stats{
  level:     1,
  endurance: 18,
  health:    5,
 }
 levelUp(&myStats)
 fmt.Println(myStats) // {2 46 230}
}
```

- Go è¯­è¨€çš„åœ°å€æ“ä½œç¬¦ä¸ä»…å¯ä»¥è·å–ç»“æ„çš„å†…å­˜åœ°å€ï¼Œè¿˜å¯ä»¥è·å–ç»“æ„ä¸­æŒ‡å®šå­—æ®µçš„å†…å­˜åœ°å€

```go
package main

import "fmt"

type stats struct {
 level             int
 endurance, health int
}

func levelUp(s *stats) {
 s.level++
 s.endurance = 18 + (14 * s.level)
 s.health = 5 * s.endurance
}

type character struct {
 name  string
 stats stats
}

func main() {
 player := character{name: "san"}
 levelUp(&player.stats)
 fmt.Printf("%+v\n", player.stats) // {level:1 endurance:32 health:160}
}
```

101. **ä¿®æ”¹æ•°ç»„**

è™½ç„¶æˆ‘ä»¬æ›´å€¾å‘äºä½¿ç”¨åˆ‡ç‰‡è€Œä¸æ˜¯æ•°ç»„ï¼Œä½†æ•°ç»„ä¹Ÿé€‚ç”¨äºä¸€äº›ä¸éœ€è¦ä¿®æ”¹é•¿åº¦çš„åœºæ™¯

```go
package main

import "fmt"

func reset(board *[8][8]rune) {
 board[0][0] = 'r'
}

func main() {
 var board [8][8]rune
 reset(&board)

 fmt.Printf("%c\n", board[0][0]) // r
}
```

::: tip æ€»ç»“
å‡½æ•°æˆ–è€…æ–¹æ³•é€šè¿‡æŒ‡é’ˆå¯ä»¥å¯¹ä¼ å…¥çš„æ•°ç»„è¿›è¡Œä¿®æ”¹ï¼Œè¿™ä¸€ç‚¹åœ¨ä¸ä½¿ç”¨æŒ‡é’ˆçš„æƒ…å†µä¸‹æ˜¯æ— æ³•åšåˆ°çš„
:::

102. **éšå¼æŒ‡é’ˆ**

- æ˜ å°„æ˜¯éšå¼æŒ‡é’ˆ

```go
func demolish(planet *map[string]string) // å¤šä½™çš„æŒ‡é’ˆ
```

- åˆ‡ç‰‡æŒ‡å‘æ•°ç»„

åˆ‡ç‰‡åœ¨æŒ‡å‘æ•°ç»„å…ƒç´ çš„æ—¶å€™ä½¿ç”¨äº† `æŒ‡é’ˆ`

- ä¿®æ”¹åˆ‡ç‰‡

```go
package main

import "fmt"

func update(planets *[]string) {
 *planets = (*planets)[0:5]
}

func main() {
 planets := []string{"a", "b", "c", "d", "e", "f", "g", "h", "i", "j"}
 update(&planets)

 fmt.Println(planets) // [a b c d e]
}
```

103. **æŒ‡é’ˆå’Œæ¥å£**

```go
package main

import (
 "fmt"
 "strings"
)

type talker interface {
 talker() string
}

func shout(t talker) {
 louder := strings.ToUpper(t.talker())
 fmt.Println(louder)
}

type martian struct {
}

func (m martian) talker() string {
 return "nick nick"
}

func main() {
 shout(martian{})  // NICK NICK
 shout(&martian{}) // NICK NICK
}

```

104. **æ˜æ™ºåœ°ä½¿ç”¨æŒ‡é’ˆ**

æŒ‡é’ˆè™½ç„¶æœ‰ç”¨ï¼Œä½†æ˜¯ä¹Ÿä¼šå¢åŠ é¢å¤–çš„å¤æ‚æ€§ã€‚æ¯•ç«Ÿå¦‚æœå€¼å¯èƒ½ä¼šåœ¨å¤šä¸ªåœ°æ–¹å‘ç”Ÿå˜åŒ–ï¼Œé‚£ä¹ˆè¿½è¸ªä»£ç å°±ä¼šå˜å¾—æ›´ä¸ºå›°éš¾ã€‚

## å…³äº nil çš„çº·çº·æ‰°æ‰°

åœ¨ Go è¯­è¨€ä¸­ï¼Œ`nil` æ˜¯ä¸€ä¸ª `é›¶å€¼`ã€‚

å¦‚æœä¸€ä¸ªæŒ‡é’ˆæ²¡æœ‰æ˜ç¡®çš„æŒ‡å‘ï¼Œé‚£ä¹ˆå®ƒçš„å€¼å°±æ˜¯ `nil`ã€‚é™¤äº†æŒ‡é’ˆï¼Œ`nilæ ‡è¯†ç¬¦`è¿˜æ˜¯ `åˆ‡ç‰‡`ã€`æ˜ å°„` å’Œ `æ¥å£` çš„ `é›¶å€¼`ã€‚

105. **ä¿æŠ¤ä½ çš„æ–¹æ³•**

å› ä¸ºå€¼ä¸º nil çš„æ¥æ”¶è€…å’Œå€¼ä¸º nil çš„å‚æ•°åœ¨è¡Œä¸ºä¸Šå¹¶æ— åŒºåˆ«ï¼Œæ‰€ä»¥ Go è¯­è¨€å³ä½¿åœ¨æ¥æ”¶è€…çš„å€¼ä¸º nil çš„æƒ…å†µä¸‹ä¹Ÿä¼šç»§ç»­è°ƒç”¨æ–¹æ³•

```go
package main

import "fmt"

type person struct {
 age int
}

func (p *person) birthday() {
 if p == nil {
  return
 }
 p.age++
}

func main() {
 var nobody *person
 fmt.Println(nobody) // <nil>

 nobody.birthday()
}
```

106. **nil å‡½æ•°å€¼**

å½“å˜é‡è¢«å£°æ˜ä¸ºå‡½æ•°ç±»å‹æ—¶ï¼Œå®ƒçš„é»˜è®¤å€¼ä¸º nil

```go
package main

import "fmt"

func main() {
 var fn func(a, b int) int
 fmt.Println(fn == nil) // true
}
```

107. **nil åˆ‡ç‰‡**

å¦‚æœåˆ‡ç‰‡åœ¨å£°æ˜ä¹‹åæ²¡æœ‰ä½¿ç”¨å¤åˆå­—é¢é‡æˆ–è€…å†…ç½®çš„ make å‡½æ•°è¿›è¡Œåˆå§‹åŒ–ï¼Œé‚£ä¹ˆå®ƒçš„å€¼å°†ä¸º nilã€‚

```go
package main

import "fmt"

func main() {
 var soup []string
 fmt.Println(soup == nil) // true

 for _, item := range soup {
  fmt.Println(item)
 }

 fmt.Println(len(soup)) // 0

 soup = append(soup, "soup1", "soup2", "soup3")
 fmt.Println(soup) // [soup1 soup2 soup3]
}
```

- ä» nil å¼€å§‹

```go
package main

import "fmt"

func mirepoix(reuslt []string) []string {
 return append(reuslt, "one", "two", "three", "four", "five")
}

func main() {
 soup := mirepoix(nil)
 fmt.Println(soup) // [one two three four five]
}
```

108. **nil æ˜ å°„**

è·Ÿåˆ‡ç‰‡çš„æƒ…å†µä¸€æ ·ï¼Œå¦‚æœæ˜ å°„åœ¨å£°æ˜ä¹‹åæ²¡æœ‰ä½¿ç”¨å¤åˆå­—é¢é‡æˆ–è€…å†…ç½®çš„ make å‡½æ•°è¿›è¡Œåˆå§‹åŒ–ï¼Œé‚£ä¹ˆå®ƒçš„å€¼å°†ä¼šæ˜¯é»˜è®¤çš„ nil

nil æ˜ å°„å¯ä»¥æ‰§è¡Œè¯»å–æ“ä½œä½†æ˜¯ä¸èƒ½æ‰§è¡Œå†™å…¥æ“ä½œ

```go
package main

import "fmt"

func main() {
 var soup map[string]int
 fmt.Println(soup == nil) // true

 measurement, ok := soup["measurement"]
 if ok {
  fmt.Println(measurement)
 }

 for key, item := range soup {
  fmt.Println(key, item)
 }
}
```

109. **nil æ¥å£**

å£°æ˜ä¸ºæ¥å£ç±»å‹çš„å˜é‡åœ¨æœªè¢«èµ‹å€¼æ—¶çš„é›¶å€¼ä¸º nil

```go
var v interface{}
fmt.Printf("%T %v %v\n", v, v, v == nil) // <nil> <nil> true
```

- Go è®¤å®šæ¥å£ç±»å‹çš„å˜é‡åªæœ‰åœ¨ç±»å‹å’Œå€¼éƒ½ä¸º nil æ—¶æ‰ç­‰äº nil

```go
var p *int
v := p
fmt.Printf("%T %v %v\n", v, v, v == nil) // *int <nil> true
```

- æ£€è§†æ¥å£å˜é‡çš„å†…éƒ¨è¡¨ç¤º

æ ¼å¼åŒ–å˜é‡ `%#v` èƒ½å¤ŸåŒæ—¶æŸ¥çœ‹å˜é‡çš„ç±»å‹å’Œå€¼

```go
var p *int
v := p
fmt.Printf("%#v\n", v) // (*int)(nil)
```

## å­°èƒ½æ— è¿‡

110. **å¤„ç†é”™è¯¯**

```go
package main

import (
 "fmt"
 "io/ioutil"
 "os"
)

func main() {
 files, err := ioutil.ReadDir("./") // 'ReadDir' is deprecated
 if err != nil {
  fmt.Println(err)
  os.Exit(1)
 }

 for _, file := range files {
  fmt.Println(file.Name())
  // .idea
  // main.go
 }
}
```

111. **å…³é”®å­— defer**

å¦‚æœä¸€ä¸ªå‡½æ•°åœ¨å†…éƒ¨ä½¿ç”¨ defer å»¶è¿Ÿäº†æŸäº›æ“ä½œï¼Œé‚£ä¹ˆ Go è¯­è¨€å°†ä¿è¯è¿™äº›è¢«å»¶è¿Ÿçš„æ“ä½œä¼šåœ¨å‡½æ•°è¿”å›ä¹‹å‰è§¦å‘

- defer å¯ä»¥å»¶è¿Ÿä»»ä½•å‡½æ•°æˆ–è€…æ–¹æ³•

```go
package main

import (
 "fmt"
 "os"
)

func proverbs(name string) error {
 f, err := os.Create(name)
 if err != nil {
  return err
 }
 defer f.Close()

 _, err = fmt.Fprintln(f, "Errors are values")
 if err != nil {
  return err
 }

 _, err = fmt.Fprintln(f, "Done.")
 return err
}

func main() {
 proverbs("./file.log")
}

```

112. **åˆ›é€ æ€§çš„é”™è¯¯å¤„ç†**

```go
package main

import (
 "fmt"
 "io"
 "os"
)

type safeWriter struct {
 w   io.Writer
 err error
}

func (sw *safeWriter) writeln(s string) {
 if sw.err != nil {
  return
 }
 _, sw.err = fmt.Fprintln(sw.w, s)
}

func proverbs(name string) error {
 f, err := os.Create(name)
 if err != nil {
  return err
 }
 defer f.Close()
 sw := safeWriter{w: f}
 sw.writeln("abcd")
 sw.writeln("efgh")
 sw.writeln("ijklmn")
 sw.writeln("ijklmnop")
 return sw.err
}

func main() {
 proverbs("./file.log")
}
```

113. **æ–°çš„é”™è¯¯**

errors åŒ…åŒ…å«ä¸€ä¸ªæ„é€ å‡½æ•°ï¼Œå®ƒæ¥å—ä¸€ä¸ªä»£è¡¨é”™è¯¯ä¿¡æ¯çš„å­—ç¬¦ä¸²ä½œä¸ºå‚æ•°

```go
error.New("out of bounds")
```

114. **æŒ‰éœ€è¿”å›é”™è¯¯**

è®¸å¤š Go åŒ…éƒ½å£°æ˜å¹¶å¯¼å‡ºäº†ä¸€äº›å˜é‡ï¼Œç”¨äºè¡¨ç¤ºå®ƒä»¬å¯èƒ½ä¼šè¿”å›çš„é”™è¯¯

- æ ¹æ®æƒ¯ä¾‹ï¼ŒGo ç¨‹åºå°†ä½¿ç”¨å¸¦æœ‰ Err å‰ç¼€çš„å˜é‡æ¥å­˜å‚¨é”™è¯¯æ¶ˆæ¯

```go
var (
 ErrBounds = errors.New("out of bounds")
 ErrDigit  = errors.New("invalid digit")
)

if !inBounds(row, column) {
 return ErrBounds
}
```

errors.New æ„é€ å‡½æ•°è¿”å›çš„æ˜¯`æŒ‡é’ˆ`

115. **è‡ªå®šä¹‰é”™è¯¯ç±»å‹**

ä¸å…¶æ¯æ¬¡åªè¿”å›ä¸€ä¸ªé”™è¯¯ï¼Œæ›´å¥½çš„åšæ³•æ˜¯ï¼Œåˆ›å»ºè‡ªå®šä¹‰ç±»ä¼¼ Set æ–¹æ³•ï¼Œè®© Set æ–¹æ³•å¯¹å‚æ•°æ‰§è¡Œå¤šç§æ£€æŸ¥ï¼Œå¹¶ä¸€æ¬¡æ€§è¿”å›æ‰€æœ‰é”™è¯¯

ä¸€èˆ¬å®šåˆ¶é”™è¯¯ç±»å‹ï¼Œéƒ½ä¼šä½¿ç”¨å•è¯`Error`ä½œä¸ºåç¼€ã€‚ä½†æœ‰æ—¶å€™ä¸ºäº†ç®€æ´ï¼Œä¹Ÿåªä½¿ç”¨å•è¯`Error`ï¼Œå¦‚ï¼š`urlåŒ…`çš„`url.Error`ä¸€æ ·

- å®šåˆ¶é”™è¯¯ç±»å‹å¯ä»¥é€šè¿‡æ»¡è¶³ error æ¥å£æ¥å®ç°

116. **ç±»å‹æ–­è¨€**

- ç±»å‹æ–­è¨€çš„ä½œç”¨ï¼Ÿ

å®ƒä¼šå°è¯•å°†å€¼ err ä» error æ¥å£ç±»å‹è½¬æ¢ä¸ºå…·ä½“çš„ SudokuError ç±»å‹

- ç±»å‹æ–­è¨€å¯ä»¥å°†å€¼ä»æ¥å£ç±»å‹è½¬æ¢ä¸ºå…·ä½“ç±»å‹æˆ–è€…å…¶ä»–æ¥å£ç±»å‹

117. **Go è¯­è¨€è™½ç„¶æ²¡æœ‰æä¾›å¼‚å¸¸æœºåˆ¶ï¼Œä½†å®ƒæœ‰ä¸€ç§åä¸º panic çš„ç±»ä¼¼æœºåˆ¶**

å¦‚æœä¸€ä¸ªå‡½æ•°æŠ›å‡ºäº†å¼‚å¸¸ä½†æ˜¯å´æ²¡æœ‰äººæ¥æ•æ‰å®ƒï¼Œé‚£ä¹ˆå¼‚å¸¸å°†å‘ä¸Šä¼ é€’è‡³è¯¥å‡½æ•°çš„è°ƒç”¨è€…ï¼Œç„¶åæ˜¯è°ƒç”¨è€…çš„è°ƒç”¨è€…ï¼Œä»¥æ­¤ç±»æ¨ï¼Œç›´åˆ°åˆ°è¾¾è¯¸å¦‚ main å‡½æ•°ä¹‹ç±»çš„è°ƒç”¨æ ˆé¡¶éƒ¨ä¸ºæ­¢ã€‚

118. **å¦‚ä½•å¼•å‘æƒŠæ**

ä¼ é€’ç»™ panic å‡½æ•°çš„å®å‚å¯ä»¥æ˜¯ä»»ä½•ç±»å‹

```go
panic("I forgot my towel")
```

::: tip æ³¨æ„
è™½ç„¶è¿”å›é”™è¯¯å€¼é€šå¸¸æ¯”ä½¿ç”¨ panic æ›´å¯å–ï¼Œä½†ç”±äº panic ä¼šåœ¨é€€å‡ºç¨‹åºä¹‹å‰æ‰§è¡Œæ‰€æœ‰è¢«å»¶è¿Ÿçš„æ“ä½œï¼Œè€Œ os.Exit ä¸ä¼šè¿™ä¹ˆåšï¼Œå› æ­¤ panic æ¯” os.Exit å¥½ä¸€äº›
:::

119. **å¤„ç†æƒŠæ**

é€šè¿‡ä½¿ç”¨å…³é”®å­— deferï¼Œç¨‹åºå¯ä»¥åœ¨å‡½æ•°è¿”å›ä¹‹å‰æ‰§è¡ŒæŒ‡å®šçš„æ¸…ç†æ“ä½œ

è¢«å»¶è¿Ÿçš„æ“ä½œå°†åœ¨å‡½æ•°è¿”å›ä¹‹å‰æ‰§è¡Œï¼Œå³ä½¿åœ¨å‘ç”ŸæƒŠæçš„æƒ…å†µä¸‹ä¹Ÿæ˜¯å¦‚æ­¤ã€‚å¦‚æœæŸä¸ªè¢«å»¶è¿Ÿçš„å‡½æ•°è°ƒç”¨äº† `recover`ï¼Œé‚£ä¹ˆæƒŠæå°†ä¼šåœæ­¢ï¼Œè€Œç¨‹åºåˆ™ä¼šç»§ç»­è¿è¡Œã€‚è¿™ç§æ¢å¤æœºåˆ¶ç±»ä¼¼äºå…¶ä»–è¯­è¨€ä¸­çš„ catchã€except å’Œ rescueã€‚

```go
package main

import "fmt"

func main() {
 defer func() {
  if e := recover(); e != nil {
   fmt.Println(e)
  }
 }()

 panic("I forgot my towel") // I forgot my towel
}
```

## ======ã€å¹¶å‘ç¼–ç¨‹ã€‘======

åœ¨ Go è¯­è¨€ä¸­ï¼Œä½ å¯ä»¥é€šè¿‡ `goroutine` å¹¶å‘æ‰§è¡Œä»»ä½•ä»£ç ï¼Œå¹¶ä½¿ç”¨ `é€šé“ï¼ˆchannelï¼‰` å®ç°å¤šä¸ª `goroutine` ä¹‹é—´çš„é€šä¿¡å’ŒååŒï¼Œä»è€Œä½¿å¾—å¤šä¸ªå¹¶å‘ä»»åŠ¡èƒ½å¤Ÿç›´æˆªäº†å½“åœ°æœç€åŒä¸€ç›®æ ‡å‰è¿›ã€‚

## goroutine å’Œå¹¶å‘

åœ¨ Go ä¸­ï¼Œç‹¬ç«‹è¿è¡Œçš„ä»»åŠ¡è¢«ç§°ä¸º`goroutine`

- ä½¿ç”¨ go è¯­å¥å¯ä»¥å¯åŠ¨ä¸€ä¸ªæ–°çš„`goroutine`ï¼Œå¹¶ä¸”è¿™ä¸ª`goroutine`å°†ä»¥å¹¶å‘æ–¹å¼è¿è¡Œ

120. **å¯åŠ¨ goroutine**

```go
package main

import (
 "fmt"
 "time"
)

func main() {
 go sleepGopher()
 time.Sleep(4 * time.Second)
}

func sleepGopher() {
 time.Sleep(3 * time.Second)
 fmt.Println("...snore...")
}
```

121. **ä¸æ­¢ä¸€ä¸ª goroutine**

æ¯æ¬¡ä½¿ç”¨å…³é”®å­— go éƒ½ä¼šäº§ç”Ÿä¸€ä¸ªæ–°çš„ `goroutine`

```go
package main

import (
 "fmt"
 "time"
)

func main() {
 for i := 0; i < 5; i++ {
  go sleepGopher(i)
 }
 // æ¯æ¬¡æ‰§è¡Œï¼Œä¸åŒçš„é¡ºåºè¾“å‡º
 // ... 2  snore...
 // ... 1  snore...
 // ... 4  snore...
 // ... 0  snore...
 // ... 3  snore...
 time.Sleep(4 * time.Second)
}

func sleepGopher(id int) {
 time.Sleep(3 * time.Second)
 fmt.Println("...", id, " snore...")
}
```

122. **é€šé“**

é€šé“ï¼ˆchannelï¼‰å¯ä»¥åœ¨å¤šä¸ª goroutine ä¹‹é—´å®‰å…¨åœ°ä¼ é€’å€¼ã€‚

ä½ åªéœ€æŠŠå¯¹è±¡æ”¾åˆ°ç®¡é“é‡Œé¢ï¼Œå®ƒå°±ä¼šé£å¿«åœ°å‡ºç°åœ¨ç®¡é“çš„å¦ä¸€ç«¯ï¼Œç„¶åå…¶ä»–äººå°±å¯ä»¥å–èµ°è¿™ä¸ªå¯¹è±¡äº†

- åˆ›å»ºé€šé“

è·Ÿåˆ›å»ºæ˜ å°„æˆ–åˆ‡ç‰‡æ—¶çš„æƒ…å†µä¸€æ ·ï¼Œåˆ›å»ºé€šé“éœ€è¦ç”¨åˆ°å†…ç½®çš„ `make` å‡½æ•°ï¼Œå¹¶ä¸”ä½ è¿˜éœ€è¦å†åˆ›å»ºæ—¶ä¸ºå…¶æŒ‡å®šç›¸åº”çš„ç±»å‹

```go
c := make(chan int)
```

- é€šè¿‡é€šé“æ¥æ”¶å€¼

é€šè¿‡ `å·¦ç®­å¤´æ“ä½œç¬¦ï¼ˆ<-ï¼‰` å‘å®ƒå‘é€å€¼æˆ–è€…ä»å®ƒé‚£é‡Œæ¥æ”¶å€¼äº†

```go 9,11,14,19,22
package main

import (
 "fmt"
 "time"
)

func main() {
 c := make(chan int)
 for i := 0; i < 5; i++ {
  go sleepGopher(i, c)
 }
 for i := 0; i < 5; i++ {
  gopherID := <-c
  fmt.Printf("Gopher ID: %d\n", gopherID)
 }
}

func sleepGopher(id int, c chan int) {
 time.Sleep(3 * time.Second)
 fmt.Println("...", id, " snore...")
 c <- id
}
```

123. **ä½¿ç”¨ select å¤„ç†å¤šä¸ªé€šé“**

æˆ‘ä»¬ä½¿ç”¨äº†å•ä¸ªé€šé“æ¥ç­‰å¾…å¤šä¸ª `goroutine`ã€‚è¿™ç§åšæ³•åœ¨æ‰€æœ‰ `goroutine` éƒ½äº§ç”Ÿç›¸åŒç±»å‹çš„å€¼æ—¶ç›¸å½“å¥½ç”¨ï¼Œä½†æƒ…å†µå¹¶ä¸æ€»æ˜¯å¦‚æ­¤ã€‚åœ¨å®é™…ä¸­ï¼Œç¨‹åºé€šå¸¸éœ€è¦ç­‰å¾…ä¸¤ç§æˆ–è€…å¤šç§ä¸åŒç±»å‹çš„å€¼ã€‚

Go æ ‡å‡†åº“æä¾›äº†ä¸€ä¸ªéå¸¸æ£’çš„å‡½æ•° `time.After` æ¥å¸®åŠ©æˆ‘ä»¬å®ç°è¿™ä¸€ç›®çš„ã€‚è¿™ä¸ªå‡½æ•°ä¼šè¿”å›ä¸€ä¸ªé€šé“ï¼Œè¯¥é€šé“ä¼šåœ¨ç»è¿‡ç‰¹å®šæ—¶é—´ä¹‹åæ¥æ”¶åˆ°ä¸€ä¸ªå€¼ï¼ˆå‘é€è¯¥å€¼çš„ `goroutine` æ˜¯ Go è¿è¡Œæ—¶çš„å…¶ä¸­ä¸€éƒ¨åˆ†ï¼‰ã€‚

```go
package main

import (
 "fmt"
 "math/rand"
 "time"
)

func sleepGopher(id int, c chan int) {
 time.Sleep(time.Duration(rand.Intn(4000)) * time.Millisecond)
 fmt.Println("...", id, " snore...")
 c <- id
}

func main() {
 c := make(chan int)
 for i := 0; i < 5; i++ {
  go sleepGopher(i, c)
 }

 timeout := time.After(2 * time.Second)
 for i := 0; i < 5; i++ {
  select {
  case gopherID := <-c:
   fmt.Println(gopherID, " has finished sleeping")
  case <-timeout:
   fmt.Println("my patience has ran out")
   return
  }
 }
}

```

::: tip æç¤º
select è¯­å¥åœ¨ä¸åŒ…å«ä»»ä½•åˆ†æ”¯çš„æƒ…å†µä¸‹å°†æ°¸è¿œåœ°ç­‰å¾…ä¸‹å»ã€‚å½“ä½ å¯åŠ¨å¤šä¸ª `goroutine` å¹¶ä¸”æ‰“ç®—è®©å®ƒä»¬`æ— é™æœŸåœ°è¿è¡Œä¸‹å»`çš„æ—¶å€™ï¼Œå°±å¯ä»¥ç”¨è¿™ä¸ªæ–¹æ³•æ¥`é˜»æ­¢`main å‡½æ•°è¿”å›ã€‚
:::

::: tip æ³¨æ„
å³ä½¿ç¨‹åºå·²ç»åœæ­¢ç­‰å¾… `goroutine`ï¼Œä½†åªè¦ `main` å‡½æ•°è¿˜æ²¡è¿”å›ï¼Œä»åœ¨è¿è¡Œçš„ `goroutine` å°±ä¼šç»§ç»­å ç”¨å†…å­˜ã€‚æ‰€ä»¥åœ¨æƒ…å†µå…è®¸çš„æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬è¿˜æ˜¯åº”è¯¥å°½é‡ç»“æŸæ— ç”¨çš„ `goroutine`ã€‚
:::

124. **è·Ÿæ˜ å°„ã€åˆ‡ç‰‡å’ŒæŒ‡é’ˆä¸€æ ·ï¼Œé€šé“çš„å€¼ä¹Ÿå¯ä»¥æ˜¯ nillï¼Œè€Œè¿™ä¸ªå€¼å®é™…ä¸Šä¹Ÿæ˜¯å®ƒä»¬é»˜è®¤çš„é›¶å€¼**

å¯¹å€¼ä¸º `nil` çš„é€šé“æ‰§è¡Œå‘é€æˆ–æ¥æ”¶æ“ä½œå¹¶ä¸ä¼šå¼•å‘æƒŠæï¼Œä½†æ˜¯ä¼šå¯¼è‡´æ“ä½œ`æ°¸ä¹…é˜»å¡`

åˆçœ‹ä¸Šå»ï¼Œå€¼ä¸º `nil` çš„é€šé“ä¼¼ä¹æ²¡ä»€ä¹ˆç”¨å¤„ï¼Œä½†äº‹å®æ°æ°ç›¸åã€‚ä¾‹å¦‚ï¼Œ**å¯¹äºä¸€ä¸ªåŒ…å« `select` è¯­å¥çš„å¾ªç¯ï¼Œå¦‚æœæˆ‘ä»¬ä¸å¸Œæœ›ç¨‹åºåœ¨æ¯æ¬¡å¾ªç¯çš„æ—¶å€™éƒ½ç­‰å¾… `select` è¯­å¥æ¶‰åŠçš„æ‰€æœ‰é€šé“ï¼Œé‚£ä¹ˆå¯ä»¥å…ˆå°†æŸäº›é€šé“è®¾ç½®ä¸º `nil`ï¼Œç­‰åˆ°å¾…å‘é€çš„å€¼å‡†å¤‡å°±ç»ªä¹‹åï¼Œå†ä¸ºé€šé“å˜é‡èµ‹äºˆä¸€ä¸ªé `nil` å€¼å¹¶æ‰§è¡Œå®é™…çš„å‘é€æ“ä½œã€‚**

::: tip é€ŸæŸ¥

1. time.After è¿”å›çš„æ˜¯ä»€ä¹ˆç±»å‹çš„å€¼ï¼Ÿ  
   é€šé“

2. å¯¹å€¼ä¸º nil çš„é€šé“æ‰§è¡Œå‘ç”Ÿæ“ä½œæˆ–æ˜¯æ¥æ”¶æ“ä½œå°†äº§ç”Ÿä»€ä¹ˆåæœï¼Ÿ  
   æ“ä½œå°†æ°¸è¿œé˜»å¡

3. select è¯­å¥çš„æ¯ä¸ªåˆ†æ”¯å¯ä»¥åŒ…å«ä»€ä¹ˆï¼Ÿ  
   ä¸€ä¸ªé€šé“æ“ä½œ
   :::

4. **é˜»å¡å’Œæ­»é”**

å½“ `goroutine` åœ¨ç­‰å¾…é€šé“çš„å‘é€æˆ–è€…æ¥æ”¶æ“ä½œçš„æ—¶å€™ï¼Œæˆ‘ä»¬å°±è¯´å®ƒè¢«`é˜»å¡`äº†

é™¤ `goroutine` æœ¬èº«å ç”¨çš„å°‘é‡å†…å­˜ä¹‹å¤–ï¼Œè¢«é˜»å¡çš„ `goroutine` å¹¶ä¸æ¶ˆè€—ä»»ä½•èµ„æºã€‚`goroutine` ä¼šé™é™åœ°åœåœ¨é‚£é‡Œï¼Œç­‰å¾…å¯¼è‡´å®ƒé˜»å¡çš„äº‹æƒ…å‘ç”Ÿï¼Œç„¶åè§£é™¤é˜»å¡ã€‚

å½“ä¸€ä¸ªæˆ–å¤šä¸ª `goroutine` å› ä¸ºæŸäº›æ°¸è¿œæ— æ³•å‘ç”Ÿçš„äº‹æƒ…è€Œè¢«é˜»å¡æ—¶ï¼Œæˆ‘ä»¬ç§°è¿™ç§æƒ…å†µä¸º`æ­»é”`ï¼Œè€Œå‡ºç°æ­»é”çš„ç¨‹åºé€šå¸¸éƒ½ä¼š`å´©æºƒ`æˆ–è€…`è¢«æŒ‚èµ·`ã€‚

```go
package main

func main() {
 c := make(chan int)
 <-c
}
```

::: tip é€ŸæŸ¥

1. è¢«é˜»å¡çš„ `goroutine` ä¼šåšä»€ä¹ˆï¼Ÿ  
   ä»€ä¹ˆéƒ½ä¸åš
   :::

2. **Go å…è®¸æˆ‘ä»¬åœ¨æ²¡æœ‰å€¼å¯ä¾›å‘é€çš„æƒ…å†µä¸‹é€šè¿‡ close å‡½æ•°å…³é—­é€šé“ï¼Œå°±åƒè¿™æ ·ï¼š`close(c)`**

é€šé“è¢«å…³é—­ä¹‹åå°†æ— æ³•å†™å…¥ä»»ä½•å€¼ï¼Œå¦‚æœå°è¯•å†™å…¥å€¼å°†ä¼šå¼•å‘æƒŠæã€‚

å°è¯•è¯»å–å·²è¢«å…³é—­çš„é€šé“å°†ä¼šè·å¾—ä¸€ä¸ªä¸é€šé“å…³å‹å¯¹åº”çš„`é›¶å€¼`ã€‚

æ‰§è¡Œä»¥ä¸‹ä»£ç å¯ä»¥è·æ‚‰é€šé“æ˜¯å¦å·²ç»è¢«å…³é—­ï¼š

```go
v, ok := <-c
```

é€šè¿‡å°†æ¥æ”¶æ“ä½œçš„æ‰§è¡Œç»“æœèµ‹å€¼ç»™ä¸¤ä¸ªå˜é‡ï¼Œæˆ‘ä»¬å¯ä»¥æ ¹æ®ç¬¬äºŒä¸ªå˜é‡çš„å€¼æ¥åˆ¤æ–­æ­¤æ¬¡é€šé“è¯»å–æ“ä½œæ˜¯å¦æˆåŠŸã€‚**å¦‚æœè¯¥å˜é‡çš„å€¼ä¸º falseï¼Œé‚£ä¹ˆè¯´æ˜é€šé“å·²è¢«å…³é—­ã€‚**

::: tip é€ŸæŸ¥

1. å°è¯•è¯»å–ä¸€ä¸ªå·²ç»å…³é—­çš„é€šé“ä¼šå¾—åˆ°ä»€ä¹ˆå€¼ï¼Ÿ  
   è¯¥é€šé“ç±»å‹çš„é›¶å€¼ã€‚

2. å¦‚ä½•æ‰èƒ½æ£€æµ‹å‡ºé€šé“æ˜¯å¦å·²ç»å…³é—­ï¼Ÿ  
   ä½¿ç”¨äºŒå€¼èµ‹å€¼è¯­å¥å³å¯ï¼šv, ok := <-cã€‚
   :::

::: tip å°ç»“

- é€šé“ç”¨äºåœ¨å¤šä¸ª `goroutine` ä¹‹é—´ä¼ é€’å€¼ã€‚
- åˆ›å»ºé€šé“éœ€è¦ç”¨åˆ°å†…ç½®çš„ `make` å‡½æ•°ï¼Œå¦‚ make(chan string)ã€‚
- `close` å‡½æ•°å¯ä»¥å…³é—­ä¸€ä¸ªé€šé“ã€‚
- `range` è¯­å¥å¯ä»¥ä»é€šé“ä¸­è¯»å–æ‰€æœ‰å€¼ï¼Œç›´åˆ°é€šé“å…³é—­ä¸ºæ­¢ã€‚
  :::

## å¹¶å‘çŠ¶æ€

127. **äº’æ–¥é”**

â€œäº’æ–¥â€ä¸€è¯åˆ™æ˜¯â€œç›¸äº’æ’æ–¥â€çš„ç¼©å†™ã€‚`goroutine` å¯ä»¥é€šè¿‡äº’æ–¥é”é˜»æ­¢å…¶ä»– `goroutine` åœ¨åŒä¸€æ—¶é—´è¿›è¡ŒæŸäº›äº‹æƒ…ï¼Œè‡³äºäº‹æƒ…çš„å…·ä½“å†…å®¹åˆ™ç”±ç¨‹åºå‘˜æŒ‡å®šã€‚

- äº’æ–¥é”å…·æœ‰ `Lock` å’Œ `Unlock` ä¸¤ä¸ªæ–¹æ³•ã€‚

- å¦‚æœæœ‰ `goroutine` å°è¯•åœ¨äº’æ–¥é”å·²ç»é”å®šçš„æƒ…å†µä¸‹è°ƒç”¨ `Lock` æ–¹æ³•ï¼Œé‚£ä¹ˆå®ƒå°±éœ€è¦ç­‰åˆ°è§£é™¤é”å®šä¹‹åæ‰èƒ½å¤Ÿå†æ¬¡ä¸Šé”ã€‚

- å’Œé€šé“ä¸ä¸€æ ·ï¼Œäº’æ–¥é”å¹¶æœªå†…ç½®åœ¨ Go è¯­è¨€å½“ä¸­ï¼Œè€Œæ˜¯é€šè¿‡ `sync` åŒ…æä¾›ã€‚

```go
package main

import "sync"

var mu sync.Mutex

func main() {
 // æˆ‘ä»¬åœ¨ä½¿ç”¨äº’æ–¥é”çš„æ—¶å€™ä¸éœ€è¦å¯¹å…¶å®æ–½åˆå§‹åŒ–--å®ƒçš„é›¶å€¼å°±æ˜¯ä¸€ä¸ªæœªä¸Šé”çš„äº’æ–¥é”ã€‚
 mu.Lock()
 defer mu.Unlock() // åœ¨å‡½æ•°è¿”å›ä¹‹å‰è§£é”äº’æ–¥é”
}
```

::: tip æ³¨æ„
defer è¯­å¥åœ¨å‡½æ•°åŒ…å«å¤šä¸ª return è¯­å¥æ—¶ç‰¹åˆ«æœ‰ç”¨ã€‚å¦‚æœæ²¡æœ‰ deferï¼Œæˆ‘ä»¬å°±éœ€è¦åœ¨æ¯ä¸ªè¿”å›è¯­å¥çš„å‰é¢éƒ½è°ƒç”¨ä¸€æ¬¡ Unlockï¼Œè€Œä¸”è¯´ä¸å®šè¿˜ä¼šå¿˜äº†å…¶ä¸­çš„æŸä¸€ä¸ª
:::

128. **ç»Ÿè®¡è®¿é—®é“¾æ¥æ¬¡æ•°**

```go
package main

import (
 "fmt"
 "math/rand"
 "sync"
)

type Visited struct {
 mu      sync.Mutex
 visited map[string]int
}

func (v *Visited) VisitLink(url string) int {
 v.mu.Lock()
 defer v.mu.Unlock()
 count := v.visited[url]
 count++
 v.visited[url] = count
 return count
}

func main() {
 v := Visited{visited: map[string]int{"www.baidu.com": 0}}
 for i := 0; i < 5; i++ {
  data := []string{"www.baidu.com", "www.google.com", "www.youtube.com"}
  randNum := rand.Intn(len(data))
  go v.VisitLink(data[randNum])
 }

 fmt.Printf("%v\n", v.visited)
}
// æ¯æ¬¡æ‰§è¡Œç»“æœä¸ä¸€æ ·ï¼Œä»¥ä¸‹æ‰§è¡Œäº†äº”æ¬¡çš„ç»“æœ
// map[www.baidu.com:3 www.youtube.com:1]
// map[www.baidu.com:2 www.youtube.com:2]
// map[www.baidu.com:1 www.google.com:2]
// map[www.baidu.com:2 www.google.com:1 www.youtube.com:2]
// map[www.baidu.com:0]
```

129. **äº’æ–¥é”çš„éšæ‚£**

å¦‚æœä¸€ä¸ª `goroutine` åœ¨é”å®šäº’æ–¥é”ä¹‹åå› ä¸ºæŸäº›äº‹æƒ…è€Œè¢«é˜»å¡ï¼Œé‚£ä¹ˆæƒ³è¦å–å¾—äº’æ–¥é”çš„å…¶ä»– `goroutine` å°±å¯èƒ½ä¼šè¢«è€½æå¾ˆé•¿ä¸€æ®µæ—¶é—´ã€‚æ›´ä¸¥é‡çš„æ˜¯ï¼Œå¦‚æœæŒæœ‰äº’æ–¥é”çš„ `goroutine` å› ä¸ºæŸäº›åŸå› è€Œå°è¯•é”å®šåŒä¸€ä¸ªäº’æ–¥é”ï¼Œé‚£ä¹ˆå°±ä¼šå¼•å‘æ­»é”--æ­£åœ¨å°è¯•æ‰§è¡ŒåŠ é”æ“ä½œçš„ `goroutine` å°†æ°¸è¿œæ— æ³•è§£é™¤å·²ç»è¢«é”å®šçš„äº’æ–¥é”ï¼Œæœ€ç»ˆå¯¼è‡´ `Lock` è°ƒç”¨è¢«æ°¸ä¹…é˜»å¡ã€‚

ä¸ºäº†ä¿è¯äº’æ–¥é”çš„ä½¿ç”¨å®‰å…¨ï¼Œæˆ‘ä»¬å¿…é¡»éµå®ˆä»¥ä¸‹è§„åˆ™ã€‚

- å°½å¯èƒ½åœ°ç®€åŒ–äº’æ–¥é”ä¿æŠ¤çš„ä»£ç ã€‚
- å¯¹æ¯ä¸€ä»½å…±äº«çŠ¶æ€åªä½¿ç”¨ä¸€ä¸ªäº’æ–¥é”ã€‚

130. **é•¿æ—¶é—´è¿è¡Œçš„å·¥ä½œè¿›ç¨‹**

æˆ‘ä»¬æŠŠè¿™ç§ä¸€ç›´å­˜åœ¨å¹¶ä¸”ç‹¬ç«‹è¿è¡Œçš„ `goroutine` ç§°ä¸º`å·¥ä½œè¿›ç¨‹ï¼ˆworkerï¼‰`

- å£°æ˜ä¸€ä¸ªæ²¡æœ‰ä»»ä½•å®é™…ç”¨é€”çš„å·¥ä½œè¿›ç¨‹çš„å‡½æ•°æ¡†æ¶

```go
package main

func worker() {
	for {
		select {
		// åœ¨æ­¤å¤„ç­‰å¾…é€šé“
		}
	}
}

func main() {
	// å¯åŠ¨ goroutine çš„æ–¹æ³•å¯åŠ¨è¿™ä¸ªå·¥ä½œè¿›ç¨‹
	go worker()
}
```

::: tip äº‹ä»¶å¾ªç¯å’Œ goroutine
æŸäº›ç¼–ç¨‹è¯­è¨€ä¼šä½¿ç”¨åä¸ºäº‹ä»¶å¾ªç¯çš„ä¸­å¿ƒå¾ªç¯ï¼ˆcentral loopï¼‰æ¥ç­‰å¾…äº‹ä»¶ï¼Œå¹¶åœ¨äº‹ä»¶å‘ç”Ÿæ—¶è°ƒç”¨ç›¸åº”çš„å·²æ³¨å†Œå‡½æ•°ã€‚Go é€šè¿‡æä¾› goroutine ä½œä¸ºæ ¸å¿ƒæ¦‚å¿µï¼Œæ¶ˆé™¤äº†å¯¹ä¸­å¿ƒå¾ªç¯çš„éœ€æ±‚ã€‚æˆ‘ä»¬å¯ä»¥æŠŠä»»ä½•å·¥ä½œè¿›ç¨‹ goroutine éƒ½çœ‹ä½œæ˜¯ç‹¬ç«‹è¿è¡Œçš„äº‹ä»¶å¾ªç¯ã€‚
:::

- æ‰“å°æ•°å­—çš„å·¥ä½œè¿›ç¨‹

```go
package main

import (
	"fmt"
	"time"
)

func worker() {
	n := 0
	next := time.After(time.Second)
	for {
		select {
		case <-next:
			n++
			fmt.Println(n)
			next = time.After(time.Second)
		}
	}
}

func main() {
	// å¯åŠ¨ goroutine çš„æ–¹æ³•å¯åŠ¨è¿™ä¸ªå·¥ä½œè¿›ç¨‹
	go worker()
}
```

::: tip é€ŸæŸ¥

1. Go æä¾›äº†ä»€ä¹ˆæ¥æ›¿ä»£äº‹ä»¶å¾ªç¯ï¼Ÿ  
   goroutine ä¸­çš„å¾ªç¯ã€‚

2. åœ¨å®ç°é•¿æ—¶é—´è¿è¡Œçš„å·¥ä½œè¿›ç¨‹ goroutine æ—¶ï¼Œä½ ä¼šä½¿ç”¨ Go ä¸­çš„å“ªäº›è¯­å¥ï¼Ÿ  
   for è¯­å¥å’Œ select è¯­å¥ã€‚

3. Go çš„é€šé“å¯ä»¥å‘é€å“ªäº›å€¼ï¼Ÿ  
   é€šé“å¯ä»¥å‘é€ä»»ä½•ç±»å‹çš„å€¼ã€‚
   :::

::: tip å°ç»“

- é™¤éå¦æœ‰å£°æ˜ï¼Œå¦åˆ™æ°¸è¿œä¸è¦åœ¨åŒä¸€æ—¶é—´ä½¿ç”¨å¤šäºä¸€ä¸ªçš„ goroutine è®¿é—®ç›¸åŒçš„çŠ¶æ€ã€‚
- ä½¿ç”¨äº’æ–¥é”å¯ä»¥ç¡®ä¿åœ¨åŒä¸€æ—¶é—´å†…ï¼Œåªèƒ½æœ‰ä¸€ä¸ª goroutine è®¿é—®æŒ‡å®šçš„çŠ¶æ€ã€‚
- ä½¿ç”¨äº’æ–¥é”å¯ä»¥åªä¸ºä¸€éƒ¨åˆ†çŠ¶æ€æä¾›ä¿æŠ¤ã€‚
- åº”è¯¥å°†åŠ é”ä¹‹åè¦åšçš„å·¥ä½œå‡è‡³æœ€å°‘ã€‚
- ä½¿ç”¨é•¿æ—¶é—´è¿è¡Œçš„ goroutine å¯ä»¥å®ç°å¸¦æœ‰ select å¾ªç¯çš„å·¥ä½œè¿›ç¨‹ã€‚
- å¯ä»¥æŠŠå·¥ä½œè¿›ç¨‹çš„å®ç°ç»†èŠ‚éšè—åœ¨æ–¹æ³•åé¢ã€‚
  :::

## ======ã€æ‰©å±•ä¹¦ç±ã€‘======

- ã€ŠGo è¯­è¨€å®æˆ˜ã€‹ï¼ˆGo in Practiceï¼‰
- ã€ŠGo Web ç¼–ç¨‹ã€‹ï¼ˆGo Web Programmingï¼‰
- ã€ŠGo è¯­è¨€å®æˆ˜ã€‹ï¼ˆGo in Actionï¼‰
