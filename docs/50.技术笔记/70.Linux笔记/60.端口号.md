---
date: 2025-08-16 13:02:11
permalink: /tech/linux/port
categories:
  - Linux
tags:
  - Linux
---

# 端口号

## 开放、关闭端口

```shell
firewall-cmd --zone=public --add-port=8888/tcp --permanent   # 开放8888端口

firewall-cmd --zone=public --remove-port=8888/tcp --permanent  #关闭8888端口

firewall-cmd --reload   # 配置立即生效
```

## 查看防火墙所有开放的端口

```shell
firewall-cmd --zone=public --list-ports
```

## 关闭防火墙（临时，重启后会重新开启）

```shell
systemctl stop firewalld.service
```

## 永久关闭防火墙（重启后也不开启）

```shell
systemctl disable firewalld
```

## 查看防火墙状态

```shell
firewall-cmd --state
```

## 查看监听的端口

```shell
netstat -lnpt
```

> 如果没有 netstat 命令，需要安装 net-tools 工具，`yum install -y net-tools`

## 检查端口被哪个进程占用

```shell
root@nyv8mcWOQ3 ~]netstat -lnpt |grep 22
tcp        0      0 0.0.0.0:22              0.0.0.0:*               LISTEN      30939/sshd
```

```shell
# 查看端口的网络连接信息命令
root@nyv8mcWOQ3 ~]netstat -tunlp | grep "nginx"
tcp        0      0 0.0.0.0:80              0.0.0.0:*               LISTEN      4826/nginx: master
tcp        0      0 0.0.0.0:888             0.0.0.0:*               LISTEN      4826/nginx: master
```

## 查看进程的详细信息

```shell
ps 1045
```

```shell
# 查询nginx进程，且只显示nginx相关信息
# | 管道符号，将第一个的命令结果，再交给第二个命令去二次加工
# grep命令用于：搜索，过滤某些信息

[root@nyv8mcWOQ3 ~]# ps -ef | grep "nginx"
root      4826     1  0 Nov16 ?        00:00:00 nginx: master process /www/server/nginx/sbin/nginx -c /www/server/nginx/conf/nginx.conf
www      12744  4826  0 Nov16 ?        00:01:08 nginx: worker process
www      12745  4826  0 Nov16 ?        00:01:19 nginx: worker process
www      12746  4826  0 Nov16 ?        00:00:07 nginx: cache manager process
root     32706 32651  0 14:08 pts/1    00:00:00 grep --color=auto nginx
```

## 中止进程

```shell
kill -9 1045
```

## 修改服务器登录默认端口

### 打开配置文件sshd_config

```shell
vi /etc/ssh/sshd_config
```

### 修改配置sshd_config

在打开的文件里，找到如下这些配置项，修改成如下的样子：

```shell
# 不允许空密码
PermitEmptyPasswords no
# 关闭密码验证登录，前提是你已经使用了 ssh 密钥验证方式登录
PasswordAuthentication no
# 如果你在服务器上手动添加了用户并将用户分配到 root 用户组，可以考虑禁止root用户登录
PermitRootLogin no

# 允许 pubkey 登录
PubkeyAuthentication yes

# Expect .ssh/authorized_keys2 to be disregarded by default in future.
AuthorizedKeysFile      .ssh/authorized_keys .ssh/authorized_keys2

# 登录的端口号
Port 39999
UseDNS no
AllowUsers rn_manager
# 只允许 ip4
AddressFamily inet
```
