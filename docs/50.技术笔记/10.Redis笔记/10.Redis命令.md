---
date: 2026-02-24 15:06:11
permalink: /redis/command
categories:
  - Rediså‘½ä»¤
tags:
  - Redis
---

# Rediså‘½ä»¤

## æ¸…ç©ºæ•°æ®åº“æ•°æ®

- `FLUSHDB` æ¸…ç©ºå½“å‰æ•°æ®åº“
- `FLUSHALL` æ¸…ç©ºæ‰€æœ‰æ•°æ®åº“
- `DEL` åˆ é™¤é”®å€¼å¯¹ï¼ˆé’ˆå¯¹å•ä¸ªæˆ–å¤šä¸ªé”®ï¼‰

## å­—ç¬¦ä¸²String

- `SET key value` è®¾ç½®é”®å€¼å¯¹
- `GET key` èŽ·å–é”®å€¼å¯¹
- `DEL key` åˆ é™¤é”®å€¼å¯¹
- `EXPIRE key seconds` è®¾ç½®é”®å€¼å¯¹çš„è¿‡æœŸæ—¶é—´
- `TTL key` æŸ¥çœ‹é”®å€¼å¯¹çš„å‰©ä½™è¿‡æœŸæ—¶é—´
- `INCR key` å¯¹é”®å€¼å¯¹è¿›è¡Œè‡ªå¢žæ“ä½œ
- `INCRBY key increment` å¯¹é”®å€¼å¯¹è¿›è¡Œè‡ªå¢žæ“ä½œï¼Œå¹¶æŒ‡å®šæ­¥é•¿
- `INCRBYFLOAT key increment` å¯¹é”®å€¼å¯¹è¿›è¡Œè‡ªå¢žæ“ä½œï¼Œå¹¶æŒ‡å®šæ­¥é•¿ï¼Œæ”¯æŒæµ®ç‚¹æ•°
- `DECR key` å¯¹é”®å€¼å¯¹è¿›è¡Œè‡ªå‡æ“ä½œ
- `DECRBY key decrement` å¯¹é”®å€¼å¯¹è¿›è¡Œè‡ªå‡æ“ä½œï¼Œå¹¶æŒ‡å®šæ­¥é•¿
- `APPEND key value` åœ¨é”®å€¼å¯¹çš„æœ«å°¾è¿½åŠ å€¼
- `STRLEN key` èŽ·å–é”®å€¼å¯¹çš„é•¿åº¦
- `MSET key1 value1 key2 value2 ...` åŒæ—¶è®¾ç½®å¤šä¸ªé”®å€¼å¯¹
- `MGET key1 key2 ...` åŒæ—¶èŽ·å–å¤šä¸ªé”®å€¼å¯¹
- `MSETNX key1 value1 key2 value2 ...` åŒæ—¶è®¾ç½®å¤šä¸ªé”®å€¼å¯¹ï¼Œå¦‚æžœé”®å·²ç»å­˜åœ¨åˆ™ä¸è¿›è¡Œè®¾ç½®
- `GETSET key value` è®¾ç½®é”®å€¼å¯¹ï¼Œå¹¶è¿”å›žæ—§å€¼
- `SETRANGE key offset value` ä»ŽæŒ‡å®šä½ç½®å¼€å§‹è®¾ç½®é”®å€¼å¯¹çš„å€¼
- `GETRANGE key start end` èŽ·å–é”®å€¼å¯¹çš„æŒ‡å®šèŒƒå›´çš„å€¼
- `SETEX key seconds value` è®¾ç½®é”®å€¼å¯¹ï¼Œå¹¶æŒ‡å®šè¿‡æœŸæ—¶é—´

## å“ˆå¸ŒHash

- `HSET key field value` è®¾ç½®å“ˆå¸Œè¡¨çš„å­—æ®µå€¼
- `HGET key field` èŽ·å–å“ˆå¸Œè¡¨çš„å­—æ®µå€¼
- `HDEL key field1 field2 ...` åˆ é™¤å“ˆå¸Œè¡¨çš„å­—æ®µ
- `HLEN key` èŽ·å–å“ˆå¸Œè¡¨çš„å­—æ®µæ•°é‡
- `HEXISTS key field` åˆ¤æ–­å“ˆå¸Œè¡¨æ˜¯å¦å­˜åœ¨æŒ‡å®šå­—æ®µ
- `HKEYS key` èŽ·å–å“ˆå¸Œè¡¨çš„æ‰€æœ‰å­—æ®µ
- `HVALS key` èŽ·å–å“ˆå¸Œè¡¨çš„æ‰€æœ‰å€¼
- `HGETALL key` èŽ·å–å“ˆå¸Œè¡¨çš„æ‰€æœ‰å­—æ®µå’Œå€¼
- `HINCRBY key field increment` å¯¹å“ˆå¸Œè¡¨çš„å­—æ®µå€¼è¿›è¡Œè‡ªå¢žæ“ä½œ
- `HINCRBYFLOAT key field increment` å¯¹å“ˆå¸Œè¡¨çš„å­—æ®µå€¼è¿›è¡Œè‡ªå¢žæ“ä½œï¼Œå¹¶æŒ‡å®šæ­¥é•¿ï¼Œæ”¯æŒæµ®ç‚¹æ•°
- `HMSET key field1 value1 field2 value2 ...` åŒæ—¶è®¾ç½®å“ˆå¸Œè¡¨çš„å¤šä¸ªå­—æ®µå€¼
- `HMGET key field1 field2 ...` åŒæ—¶èŽ·å–å“ˆå¸Œè¡¨çš„å¤šä¸ªå­—æ®µå€¼
- `HSETNX key field value` è®¾ç½®å“ˆå¸Œè¡¨çš„å­—æ®µå€¼ï¼Œå¦‚æžœå­—æ®µå·²ç»å­˜åœ¨åˆ™ä¸è¿›è¡Œè®¾ç½®
- `HSTRLEN key field` èŽ·å–å“ˆå¸Œè¡¨çš„å­—æ®µå€¼çš„é•¿åº¦

## åˆ—è¡¨List

1. ArrayListä½¿ç”¨æ•°ç»„æ–¹å¼
2. LinkedListä½¿ç”¨åŒå‘é“¾è¡¨æ–¹å¼
3. åŒå‘é“¾è¡¨ä¸­å¢žåŠ æ•°æ®
4. åŒå‘é“¾è¡¨ä¸­åˆ é™¤æ•°æ®

### ðŸ“Œ æ ¸å¿ƒä½¿ç”¨åœºæ™¯

`RPopLPush/BRPopLPush` çš„æ ¸å¿ƒä»·å€¼æ˜¯**åŽŸå­æ€§åœ°ä»Žæºåˆ—è¡¨å³ä¾§å¼¹å‡ºå¹¶åŽ‹å…¥ç›®æ ‡åˆ—è¡¨**ï¼Œå¸¸ç”¨äºŽ**å¯é é˜Ÿåˆ—ã€å¾ªçŽ¯ä»»åŠ¡ã€å»¶è¿Ÿ / é‡è¯•å¤„ç†**ç­‰åœºæ™¯ï¼Œè§£å†³æ™®é€š RPOP æ˜“ä¸¢æ¶ˆæ¯ã€æ¶ˆè´¹çŠ¶æ€éš¾ç»´æŠ¤çš„é—®é¢˜ã€‚

- **å¯é æ¶ˆæ¯é˜Ÿåˆ—ï¼ˆç”Ÿäº§æ¶ˆè´¹ï¼‰**

ç”Ÿäº§è€… LPUSH å…¥é˜Ÿï¼›æ¶ˆè´¹è€…ç”¨ BRPopLPushï¼ˆé˜»å¡žç‰ˆï¼‰åŽŸå­èŽ·å–å¹¶ç§»å…¥ â€œå¤„ç†ä¸­â€ åˆ—è¡¨ã€‚å¤„ç†å®Œæˆç”¨ LREM ç§»é™¤ï¼›å¤±è´¥ / è¶…æ—¶åˆ™å°† â€œå¤„ç†ä¸­â€ å…ƒç´ ç§»å›žå¾…å¤„ç†é˜Ÿåˆ—ï¼Œé˜²æ¶ˆæ¯ä¸¢å¤±ã€‚

ä¾‹ï¼šè®¢å•åˆ›å»ºåŽå‘é€šçŸ¥ã€æ—¥å¿—æ”¶é›†ã€å¼‚æ­¥ä»»åŠ¡è°ƒåº¦ã€‚

- **å»¶è¿Ÿ / é‡è¯•ä»»åŠ¡ï¼ˆæ­»ä¿¡ / é‡è¯•é˜Ÿåˆ—ï¼‰**

å…ˆå…¥å¾…å¤„ç†é˜Ÿåˆ—ï¼›æ¶ˆè´¹å¤±è´¥æ—¶ï¼Œå°†å…ƒç´ ç§»å…¥é‡è¯• / æ­»ä¿¡åˆ—è¡¨ï¼ŒæŒ‰è¶…æ—¶æˆ–ä¼˜å…ˆçº§é‡æ–°å¤„ç†ã€‚

ä¾‹ï¼šæ”¯ä»˜å›žè°ƒå¤±è´¥é‡è¯•ã€ç¬¬ä¸‰æ–¹æŽ¥å£è°ƒç”¨å¤±è´¥å…œåº•ã€‚

- **å¾ªçŽ¯ä»»åŠ¡ / çŽ¯å½¢é˜Ÿåˆ—ï¼ˆè´Ÿè½½å‡è¡¡ï¼‰**

æºåˆ—è¡¨ä¸Žç›®æ ‡åˆ—è¡¨åŒåï¼Œå®žçŽ°çŽ¯å½¢æµè½¬ï¼›å¤šæ¶ˆè´¹è€…ç«žäº‰å–ä»»åŠ¡ï¼Œå¤©ç„¶è´Ÿè½½å‡è¡¡ã€‚

ä¾‹ï¼šå¤š worker å¹¶å‘å¤„ç†ä»»åŠ¡ï¼Œé¿å…å•èŠ‚ç‚¹è¿‡è½½ã€‚

- **æ‰¹é‡å¤„ç†ä¸Žè¿›åº¦è¿½è¸ª**

ä¸´æ—¶å°†æ‰¹é‡å…ƒç´ ç§»å…¥ â€œå¤„ç†ä¸­â€ åˆ—è¡¨ï¼Œåˆ†æ‰¹æ‰§è¡Œï¼›å®ŒæˆåŽæ‰¹é‡æ¸…ç†ï¼Œä¾¿äºŽç›‘æŽ§è¿›åº¦ä¸Žå¤±è´¥æ¢å¤ã€‚

ä¾‹ï¼šæ‰¹é‡æ•°æ®æ¸…æ´—ã€æŠ¥è¡¨ç”Ÿæˆã€ç”¨æˆ·æ‰¹é‡æ“ä½œã€‚

#### å¸¸ç”¨å‘½ä»¤

- `LPUSH key value1 value2 ...` å°†ä¸€ä¸ªæˆ–å¤šä¸ªå€¼æ’å…¥åˆ°åˆ—è¡¨çš„å¤´éƒ¨
- `RPUSH key value1 value2 ...` å°†ä¸€ä¸ªæˆ–å¤šä¸ªå€¼æ’å…¥åˆ°åˆ—è¡¨çš„å°¾éƒ¨
- `LPOP key` ç§»é™¤å¹¶è¿”å›žåˆ—è¡¨çš„ç¬¬ä¸€ä¸ªå…ƒç´ 
- `RPOP key` ç§»é™¤å¹¶è¿”å›žåˆ—è¡¨çš„æœ€åŽä¸€ä¸ªå…ƒç´ 
- `LPUSHX key value` å°†ä¸€ä¸ªå€¼æ’å…¥åˆ°åˆ—è¡¨çš„å¤´éƒ¨ï¼Œå¦‚æžœåˆ—è¡¨ä¸å­˜åœ¨åˆ™ä¸è¿›è¡Œæ’å…¥
- `LINDEX key index` èŽ·å–åˆ—è¡¨æŒ‡å®šç´¢å¼•çš„å…ƒç´ 
- `LLEN key` èŽ·å–åˆ—è¡¨çš„é•¿åº¦
- `LRANGE key start stop` èŽ·å–åˆ—è¡¨æŒ‡å®šèŒƒå›´çš„å…ƒç´ 
- `LREM key count value` ç§»é™¤åˆ—è¡¨ä¸­æŒ‡å®šæ•°é‡çš„å€¼
- `LSET key index value` è®¾ç½®åˆ—è¡¨æŒ‡å®šç´¢å¼•çš„å…ƒç´ 
- `LTRIM key start stop` ä¿®å‰ªåˆ—è¡¨ï¼Œåªä¿ç•™æŒ‡å®šèŒƒå›´çš„å…ƒç´ 
- `LINSERT key BEFORE|AFTER pivot value` åœ¨åˆ—è¡¨ä¸­æ’å…¥å€¼ï¼ŒæŒ‡å®šæ’å…¥ä½ç½®ä¸ºæŒ‡å®šå€¼çš„å‰é¢æˆ–åŽé¢
- `RPOPLPUSH source destination` ç§»é™¤åˆ—è¡¨çš„æœ€åŽä¸€ä¸ªå…ƒç´ ï¼Œå¹¶å°†è¯¥å…ƒç´ æ’å…¥åˆ°å¦ä¸€ä¸ªåˆ—è¡¨çš„å¤´éƒ¨
- `BLPOP key1 key2 ... timeout` ä»Žåˆ—è¡¨çš„å¤´éƒ¨ç§»é™¤å¹¶è¿”å›žç¬¬ä¸€ä¸ªéžç©ºåˆ—è¡¨çš„ç¬¬ä¸€ä¸ªå…ƒç´ ï¼Œå¦‚æžœæ‰€æœ‰åˆ—è¡¨éƒ½ä¸ºç©ºï¼Œåˆ™ç­‰å¾…æŒ‡å®šçš„æ—¶é—´
- `BRPOP key1 key2 ... timeout` ä»Žåˆ—è¡¨çš„å°¾éƒ¨ç§»é™¤å¹¶è¿”å›žç¬¬ä¸€ä¸ªéžç©ºåˆ—è¡¨çš„æœ€åŽä¸€ä¸ªå…ƒç´ ï¼Œå¦‚æžœæ‰€æœ‰åˆ—è¡¨éƒ½ä¸ºç©ºï¼Œåˆ™ç­‰å¾…æŒ‡å®šçš„æ—¶é—´

#### ä¸¤ç«¯æ·»åŠ 

```redis
127.0.0.1:6379> lpush mylist a b c
(integer) 3
127.0.0.1:6379> lpush mylist 1 2 3
(integer) 6
127.0.0.1:6379> rpush mylist2 a b c
(integer) 3
127.0.0.1:6379> rpush mylist2 1 2 3
(integer) 6
127.0.0.1:6379> lrange mylist 0 5
1) "3"
2) "2"
3) "1"
4) "c"
5) "b"
6) "a"
127.0.0.1:6379> lrange mylist2 0 -1
1) "a"
2) "b"
3) "c"
4) "1"
5) "2"
6) "3"
127.0.0.1:6379> lrange mylist2 0 -2
1) "a"
2) "b"
3) "c"
4) "1"
5) "2"
127.0.0.1:6379> lpushx mylist x
(integer) 6
127.0.0.1:6379> lrange mylist 0 -1
1) "x"
2) "2"
3) "1"
4) "c"
5) "b"
6) "a"
127.0.0.1:6379> lpushx mylist3 x
(integer) 0
127.0.0.1:6379> rpushx mylist2 y
(integer) 6
127.0.0.1:6379> lrange mylist2 0 -1
1) "a"
2) "b"
3) "c"
4) "1"
5) "2"
6) "y"
```

#### ä¸¤ç«¯å¼¹å‡º

```redis
127.0.0.1:6379> lrange mylist 0 -1
1) "3"
2) "2"
3) "1"
4) "c"
5) "b"
6) "a"
127.0.0.1:6379> lpop mylist
"3"
127.0.0.1:6379> lrange mylist 0 -1
1) "2"
2) "1"
3) "c"
4) "b"
5) "a"
127.0.0.1:6379> lrange mylist2 0 -1
1) "a"
2) "b"
3) "c"
4) "1"
5) "2"
6) "3"
127.0.0.1:6379> rpop mylist2
"3"
127.0.0.1:6379> lrange mylist2 0 -1
1) "a"
2) "b"
3) "c"
4) "1"
5) "2"
```

#### èŽ·å–åˆ—è¡¨å…ƒç´ ä¸ªæ•°

```redis
127.0.0.1:6379> llen mylist
(integer) 5
127.0.0.1:6379> llen mylist2
(integer) 5
127.0.0.1:6379> llen mylist3
(integer) 0
```

#### åˆ é™¤æŒ‡å®šå…ƒç´ 

```redis
127.0.0.1:6379> lpush mylist3 1 2 3
(integer) 3
127.0.0.1:6379> lpush mylist3 1 2 3
(integer) 6
127.0.0.1:6379> lpush mylist3 1 2 3
(integer) 9
127.0.0.1:6379> lrange mylist3 0 -1
1) "3"
2) "2"
3) "1"
4) "3"
5) "2"
6) "1"
7) "3"
8) "2"
9) "1"
127.0.0.1:6379> lrem mylist3 2 3
(integer) 2
127.0.0.1:6379> lrange mylist3 0 -1
1) "2"
2) "1"
3) "2"
4) "1"
5) "3"
6) "2"
7) "1"
127.0.0.1:6379> lrem mylist3 -2 1
(integer) 2
127.0.0.1:6379> lrange mylist3 0 -1
1) "2"
2) "1"
3) "2"
4) "3"
5) "2"
127.0.0.1:6379> lrem mylist3 0 2
(integer) 3
127.0.0.1:6379> lrange mylist3 0 -1
1) "1"
2) "3"
```

#### è®¾ç½®åˆ—è¡¨æŒ‡å®šç´¢å¼•çš„å…ƒç´ 

```redis
127.0.0.1:6379> lset mylist 3 mmm
OK
127.0.0.1:6379> lrange mylist 0 -1
1) "x"
2) "2"
3) "1"
4) "mmm"
5) "b"
6) "a"
```

#### æŒ‡å®šæ’å…¥ä½ç½®ä¸ºæŒ‡å®šå€¼çš„å‰é¢æˆ–åŽé¢æ’å…¥å€¼

```redis
127.0.0.1:6379> lpush mylist4 a b c
(integer) 3
127.0.0.1:6379> lpush mylist4 a b c
(integer) 6
127.0.0.1:6379> lrange mylist4 0 -1
1) "c"
2) "b"
3) "a"
4) "c"
5) "b"
6) "a"
127.0.0.1:6379> linsert mylist4 before b 11
(integer) 7
127.0.0.1:6379> lrange mylist4 0 -1
1) "c"
2) "11"
3) "b"
4) "a"
5) "c"
6) "b"
7) "a"
127.0.0.1:6379> linsert mylist4 after b 22
(integer) 8
127.0.0.1:6379> lrange mylist4 0 -1
1) "c"
2) "11"
3) "b"
4) "22"
5) "a"
6) "c"
7) "b"
8) "a"
```

#### ç§»é™¤åˆ—è¡¨çš„æœ€åŽä¸€ä¸ªå…ƒç´ ï¼Œå¹¶å°†è¯¥å…ƒç´ æ’å…¥åˆ°å¦ä¸€ä¸ªåˆ—è¡¨çš„å¤´éƒ¨

```redis
127.0.0.1:6379> lpush mylist5 1 2 3
(integer) 3
127.0.0.1:6379> lpush mylist6 a b c
(integer) 3
127.0.0.1:6379> lrange mylist5 0 -1
1) "3"
2) "2"
3) "1"
127.0.0.1:6379> lrange mylist6 0 -1
1) "c"
2) "b"
3) "a"
127.0.0.1:6379> rpoplpush mylist5 mylist6
"1"
127.0.0.1:6379> lrange mylist5 0 -1
1) "3"
2) "2"
127.0.0.1:6379> lrange mylist6 0 -1
1) "1"
2) "c"
3) "b"
4) "a"
```

## é›†åˆSet

å’ŒListç±»åž‹ä¸åŒçš„æ˜¯ï¼Œ**Seté›†åˆä¸­ä¸å…è®¸å‡ºçŽ°é‡å¤çš„å…ƒç´ **ã€‚

Setå¯åŒ…æ‹¬çš„æœ€å¤§å…ƒç´ æ•°é‡æ˜¯ 4294967295ã€‚

é›†åˆå¯ä»¥ç”¨äºŽå­˜å‚¨ä¸€ç»„ä¸é‡å¤çš„å…ƒç´ ï¼Œä¾‹å¦‚ç”¨æˆ·æ ‡ç­¾ã€å•†å“åˆ†ç±»ç­‰ã€‚

é›†åˆçš„**åº•å±‚å®žçŽ°æ˜¯å“ˆå¸Œè¡¨**ï¼Œå› æ­¤å®ƒæ”¯æŒå¿«é€Ÿçš„æ’å…¥ã€åˆ é™¤å’ŒæŸ¥æ‰¾æ“ä½œã€‚

### å¸¸ç”¨å‘½ä»¤

- `SADD key member1 [member2 ...]` å‘é›†åˆä¸­æ·»åŠ ä¸€ä¸ªæˆ–å¤šä¸ªå…ƒç´ 
- `SREM key member1 [member2 ...]` ä»Žé›†åˆä¸­ç§»é™¤ä¸€ä¸ªæˆ–å¤šä¸ªå…ƒç´ 
- `SMEMBERS key` èŽ·å–é›†åˆä¸­çš„æ‰€æœ‰å…ƒç´ 
- `SISMEMBER key member` åˆ¤æ–­å…ƒç´ æ˜¯å¦åœ¨é›†åˆä¸­
- `SCARD key` èŽ·å–é›†åˆä¸­å…ƒç´ çš„æ•°é‡
- `SPOP key [count]` éšæœºç§»é™¤å¹¶è¿”å›žé›†åˆä¸­çš„ä¸€ä¸ªæˆ–å¤šä¸ªå…ƒç´ 
- `SRANDMEMBER key [count]` éšæœºè¿”å›žé›†åˆä¸­çš„ä¸€ä¸ªæˆ–å¤šä¸ªå…ƒç´ 
- `SINTER key1 [key2 ...]` è¿”å›žå¤šä¸ªé›†åˆçš„äº¤é›†
- `SUNION key1 [key2 ...]` è¿”å›žå¤šä¸ªé›†åˆçš„å¹¶é›†
- `SDIFF key1 [key2 ...]` è¿”å›žå¤šä¸ªé›†åˆçš„å·®é›†
- `SINTERSTORE destination key1 [key2 ...]` å°†å¤šä¸ªé›†åˆçš„äº¤é›†å­˜å‚¨åˆ° destination é›†åˆä¸­
- `SUNIONSTORE destination key1 [key2 ...]` å°†å¤šä¸ªé›†åˆçš„å¹¶é›†å­˜å‚¨åˆ° destination é›†åˆä¸­
- `SDIFFSTORE destination key1 [key2 ...]` å°†å¤šä¸ªé›†åˆçš„å·®é›†å­˜å‚¨åˆ° destination é›†åˆä¸­

### æ·»åŠ å…ƒç´ 

```redis
127.0.0.1:6379> sadd myset a b c
(integer) 3
127.0.0.1:6379> sadd myset a
(integer) 0
127.0.0.1:6379> srem myset b c
(integer) 2
127.0.0.1:6379> smembers myset
1) "a"
```

### åˆ¤æ–­å…ƒç´ æ˜¯å¦åœ¨é›†åˆä¸­

```redis
127.0.0.1:6379> sismember myset a
(integer) 1
127.0.0.1:6379> sismember myset x
(integer) 0
```

### èŽ·å–é›†åˆä¸­å·®é›†å…ƒç´ 

```redis
127.0.0.1:6379> sadd mya1 a b c
(integer) 3
127.0.0.1:6379> sadd myb1 a c 1 2
(integer) 4
127.0.0.1:6379> sdiff mya1 myb1
1) "b"
```

### èŽ·å–é›†åˆä¸­äº¤é›†å…ƒç´ 

```redis
127.0.0.1:6379> sadd mya2 a b c
(integer) 3
127.0.0.1:6379> sadd myb2 a c 1 2
(integer) 4
127.0.0.1:6379> sinter mya2 myb2
1) "a"
2) "c"
```

### èŽ·å–é›†åˆä¸­å¹¶é›†å…ƒç´ 

```redis
127.0.0.1:6379> sadd mya3 a b c
(integer) 3
127.0.0.1:6379> sadd myb3 a c 1 2
(integer) 4
127.0.0.1:6379> sunion mya3 myb3
1) "c"
2) "a"
3) "1"
4) "b"
5) "2"
```

### èŽ·å–é›†åˆä¸­å…ƒç´ ä¸ªæ•°

```redis
127.0.0.1:6379> scard myb3
(integer) 4
```

### éšæœºè¿”å›žé›†åˆä¸­çš„ä¸€ä¸ªæˆ–å¤šä¸ªå…ƒç´ 

```redis
127.0.0.1:6379> srandmember myb3
"1"
127.0.0.1:6379> srandmember myb3
"2"
127.0.0.1:6379> srandmember myb3
"a"
127.0.0.1:6379> srandmember myb3 2
1) "1"
2) "2"
127.0.0.1:6379> srandmember myb3 2
1) "c"
2) "2"
```

### å°†å¤šä¸ªé›†åˆçš„å·®é›†å­˜å‚¨åˆ° destination é›†åˆä¸­

```redis
127.0.0.1:6379> sdiffstore my1 mya1 myb1
(integer) 1
127.0.0.1:6379> smembers my1
1) "b"
```

### å°†å¤šä¸ªé›†åˆçš„äº¤é›†å­˜å‚¨åˆ° destination é›†åˆä¸­

```redis
127.0.0.1:6379> sinter mya2 myb2
1) "a"
2) "c"
127.0.0.1:6379> sinterstore my2 mya2 myb2
(integer) 2
127.0.0.1:6379> smembers my2
1) "a"
2) "c"
```

### å°†å¤šä¸ªé›†åˆçš„å¹¶é›†å­˜å‚¨åˆ° destination é›†åˆä¸­

```redis
127.0.0.1:6379> sunion mya3 myb3
1) "c"
2) "a"
3) "1"
4) "b"
5) "2"
127.0.0.1:6379> sunionstore my3 mya3 myb3
(integer) 5
127.0.0.1:6379> smembers my3
1) "a"
2) "b"
3) "c"
4) "1"
5) "2"
```

## æœ‰åºé›†åˆSorted-Set

æœ‰åºé›†åˆå’Œé›†åˆä¸€æ ·ä¹Ÿæ˜¯stringç±»åž‹å…ƒç´ çš„é›†åˆï¼Œä¸”ä¸å…è®¸é‡å¤çš„æˆå‘˜ã€‚

ä¸åŒçš„æ˜¯æ¯ä¸ªå…ƒç´ éƒ½ä¼šå…³è”ä¸€ä¸ªdoubleç±»åž‹çš„åˆ†æ•°ã€‚redisæ­£æ˜¯é€šè¿‡åˆ†æ•°æ¥ä¸ºé›†åˆä¸­çš„æˆå‘˜è¿›è¡Œä»Žå°åˆ°å¤§çš„æŽ’åºã€‚

æœ‰åºé›†åˆçš„æˆå‘˜æ˜¯å”¯ä¸€çš„ï¼Œä½†åˆ†æ•°(score)å´å¯ä»¥é‡å¤ã€‚

æœ‰åºé›†åˆçš„åº•å±‚å®žçŽ°ç”±**è·³è·ƒè¡¨**å’Œ**å“ˆå¸Œè¡¨**ç»„æˆã€‚

### ðŸ“Œ æ ¸å¿ƒä½¿ç”¨åœºæ™¯

- æŽ’è¡Œæ¦œï¼ˆå¦‚å¤§åž‹åœ¨çº¿æ¸¸æˆç§¯åˆ†æŽ’è¡Œæ¦œï¼‰
- å¸¦æƒé‡çš„æŠ•ç¥¨ç³»ç»Ÿ
- åœ°ç†ä½ç½®ç³»ç»Ÿ
- å¸¦æƒé‡çš„éšæœºå…ƒç´ é€‰æ‹©
- å¸¦æƒé‡çš„åˆ†æ•°æŽ’å
- æž„å»ºç´¢å¼•æ•°æ®

### å¸¸ç”¨å‘½ä»¤

- `ZADD key score1 member1 [score2 member2 ...]` å‘æœ‰åºé›†åˆä¸­æ·»åŠ ä¸€ä¸ªæˆ–å¤šä¸ªæˆå‘˜ï¼Œæˆ–è€…æ›´æ–°å·²å­˜åœ¨æˆå‘˜çš„åˆ†æ•°
- `ZREM key member [member ...]` ä»Žæœ‰åºé›†åˆä¸­ç§»é™¤ä¸€ä¸ªæˆ–å¤šä¸ªæˆå‘˜
- `ZCARD key` èŽ·å–æœ‰åºé›†åˆä¸­æˆå‘˜çš„æ•°é‡
- `ZCOUNT key min max` èŽ·å–æœ‰åºé›†åˆä¸­æŒ‡å®šåˆ†æ•°èŒƒå›´å†…çš„æˆå‘˜æ•°é‡
- `ZRANGE key start stop [WITHSCORES]` èŽ·å–æœ‰åºé›†åˆä¸­æŒ‡å®šç´¢å¼•èŒƒå›´å†…çš„æˆå‘˜
- `ZREVRANGE key start stop [WITHSCORES]` èŽ·å–æœ‰åºé›†åˆä¸­æŒ‡å®šç´¢å¼•èŒƒå›´å†…çš„æˆå‘˜ï¼ŒæŒ‰åˆ†æ•°ä»Žé«˜åˆ°ä½ŽæŽ’åº
- `ZINCRBY key increment member` å¢žåŠ æœ‰åºé›†åˆä¸­æŒ‡å®šæˆå‘˜çš„åˆ†æ•°
- `ZPOPMAX key [count]` ç§»é™¤å¹¶è¿”å›žæœ‰åºé›†åˆä¸­åˆ†æ•°æœ€å¤§çš„å…ƒç´ 
- `ZPOPMIN key [count]` ç§»é™¤å¹¶è¿”å›žæœ‰åºé›†åˆä¸­åˆ†æ•°æœ€å°çš„å…ƒç´ 
- `ZRANGEBYSCORE key min max [WITHSCORES]` èŽ·å–æœ‰åºé›†åˆä¸­æŒ‡å®šåˆ†æ•°èŒƒå›´å†…çš„æˆå‘˜
- `ZRANK key member` èŽ·å–æœ‰åºé›†åˆä¸­æŒ‡å®šæˆå‘˜çš„æŽ’åï¼ˆä»Žä½Žåˆ°é«˜ï¼‰
- `ZREMRANGEBYRANK key start stop` ç§»é™¤æœ‰åºé›†åˆä¸­æŒ‡å®šç´¢å¼•èŒƒå›´å†…çš„æˆå‘˜
- `ZREMRANGEBYSCORE key min max` ç§»é™¤æœ‰åºé›†åˆä¸­æŒ‡å®šåˆ†æ•°èŒƒå›´å†…çš„æˆå‘˜
- `ZREVRANGEBYSCORE key max min [WITHSCORES]` èŽ·å–æœ‰åºé›†åˆä¸­æŒ‡å®šåˆ†æ•°èŒƒå›´å†…çš„æˆå‘˜ï¼ŒæŒ‰åˆ†æ•°ä»Žé«˜åˆ°ä½ŽæŽ’åº
- `ZREVRANK key member` èŽ·å–æœ‰åºé›†åˆä¸­æŒ‡å®šæˆå‘˜çš„æŽ’åï¼ˆä»Žé«˜åˆ°ä½Žï¼‰
- `ZSCAN key cursor [MATCH pattern] [COUNT count]` è¿­ä»£æœ‰åºé›†åˆä¸­çš„å…ƒç´ 
- `ZSCORE key member` èŽ·å–æœ‰åºé›†åˆä¸­æŒ‡å®šæˆå‘˜çš„åˆ†æ•°
- `ZDIFF key1 [key2 ...]` è®¡ç®—ç»™å®šçš„ä¸€ä¸ªæˆ–å¤šä¸ªæœ‰åºé›†åˆçš„å·®é›†
- `ZDIFFSTORE destination numkeys key [key ...]` è®¡ç®—ç»™å®šçš„ä¸€ä¸ªæˆ–å¤šä¸ªæœ‰åºé›†åˆçš„å·®é›†ï¼Œå¹¶å°†ç»“æžœå­˜å‚¨åœ¨ destination ä¸­
- `ZINTER key1 [key2 ...]` è®¡ç®—ç»™å®šçš„ä¸€ä¸ªæˆ–å¤šä¸ªæœ‰åºé›†åˆçš„äº¤é›†
- `ZINTERSTORE destination numkeys key [key ...] [WEIGHTS weight [weight ...]] [AGGREGATE SUM|MIN|MAX]` è®¡ç®—ç»™å®šçš„ä¸€ä¸ªæˆ–å¤šä¸ªæœ‰åºé›†åˆçš„äº¤é›†ï¼Œå¹¶å°†ç»“æžœå­˜å‚¨åœ¨ destination ä¸­
- `ZLEXCOUNT key min max` èŽ·å–æœ‰åºé›†åˆä¸­æŒ‡å®šå­—å…¸èŒƒå›´å†…çš„æˆå‘˜æ•°é‡
- `ZRANGEBYLEX key min max [LIMIT offset count]` èŽ·å–æœ‰åºé›†åˆä¸­æŒ‡å®šå­—å…¸èŒƒå›´å†…çš„æˆå‘˜
- `ZREMRANGEBYLEX key min max` ç§»é™¤æœ‰åºé›†åˆä¸­æŒ‡å®šå­—å…¸èŒƒå›´å†…çš„æˆå‘˜
- `ZREVRANGEBYLEX key max min [LIMIT offset count]` èŽ·å–æœ‰åºé›†åˆä¸­æŒ‡å®šå­—å…¸èŒƒå›´å†…çš„æˆå‘˜ï¼ŒæŒ‰å­—å…¸åºä»Žé«˜åˆ°ä½ŽæŽ’åº
- `ZUNION key1 [key2 ...]` è®¡ç®—ç»™å®šçš„ä¸€ä¸ªæˆ–å¤šä¸ªæœ‰åºé›†åˆçš„å¹¶é›†
- `ZUNIONSTORE destination numkeys key [key ...] [WEIGHTS weight [weight ...]] [AGGREGATE SUM|MIN|MAX]` è®¡ç®—ç»™å®šçš„ä¸€ä¸ªæˆ–å¤šä¸ªæœ‰åºé›†åˆçš„å¹¶é›†ï¼Œå¹¶å°†ç»“æžœå­˜å‚¨åœ¨ destination ä¸­

### æ·»åŠ å…ƒç´ 

```redis
127.0.0.1:6379> zadd mysort 70 zs 80 ls 90 ww
(integer) 3
127.0.0.1:6379> zadd mysort 100 zs
(integer) 0
127.0.0.1:6379> zadd mysort 60 tom
(integer) 1
```

### èŽ·å¾—å…ƒç´ 

```redis
127.0.0.1:6379> zscore mysort zs
"100"
```

### èŽ·å–å…ƒç´ ä¸ªæ•°

```redis
127.0.0.1:6379> zcard mysort
(integer) 4
```

### åˆ é™¤å…ƒç´ 

```redis
127.0.0.1:6379> zrem mysort tom ww
(integer) 2
127.0.0.1:6379> zcard mysort
(integer) 2
```

### èŽ·å–æŒ‡å®šç´¢å¼•èŒƒå›´å†…çš„å…ƒç´ (ä»Žå°åˆ°å¤§)

```redis
127.0.0.1:6379> zadd mysort 85 jack 95 rose
(integer) 2
127.0.0.1:6379> zrange mysort 0 -1
1) "ls"
2) "jack"
3) "rose"
4) "zs"
127.0.0.1:6379> zrange mysort 0 -1 withscores
1) "ls"
2) "80"
3) "jack"
4) "85"
5) "rose"
6) "95"
7) "zs"
8) "100"
```

### èŽ·å–æŒ‡å®šç´¢å¼•èŒƒå›´å†…çš„å…ƒç´ (ä»Žå¤§åˆ°å°)

```redis
127.0.0.1:6379> zrevrange mysort 0 -1 withscores
1) "zs"
2) "100"
3) "rose"
4) "95"
5) "jack"
6) "85"
7) "ls"
8) "80"
```

### ç§»é™¤æœ‰åºé›†åˆä¸­æŒ‡å®šç´¢å¼•èŒƒå›´å†…çš„æˆå‘˜

```redis
127.0.0.1:6379> zremrangebyrank mysort 0 4
(integer) 4
127.0.0.1:6379> zrange mysort 0 -1
(empty array)
```

### ç§»é™¤æœ‰åºé›†åˆä¸­æŒ‡å®šåˆ†æ•°èŒƒå›´å†…çš„æˆå‘˜

```redis
127.0.0.1:6379> zadd mysort 80 zs 90 ls 100 ws
(integer) 3
127.0.0.1:6379> zremrangebyscore mysort 80 100
(integer) 3
127.0.0.1:6379> zrange mysort 0 -1
(empty array)
```

### èŽ·å–æœ‰åºé›†åˆä¸­æŒ‡å®šåˆ†æ•°èŒƒå›´å†…çš„æˆå‘˜

```redis
127.0.0.1:6379> zadd mysort 70 zs 80 ls 90 ws
(integer) 3
127.0.0.1:6379> zrangebyscore mysort 0 100
1) "zs"
2) "ls"
3) "ws"
127.0.0.1:6379> zrangebyscore mysort 0 100 withscores
1) "zs"
2) "70"
3) "ls"
4) "80"
5) "ws"
6) "90"
127.0.0.1:6379> zrangebyscore mysort 0 100 withscores limit 0 2
1) "zs"
2) "70"
3) "ls"
4) "80"
```

### å¢žåŠ æœ‰åºé›†åˆä¸­æŒ‡å®šæˆå‘˜çš„åˆ†æ•°

```redis
127.0.0.1:6379> zincrby mysort 3 ls
"83"
127.0.0.1:6379> zscore mysort ls
"83"
```

### èŽ·å–æœ‰åºé›†åˆä¸­æŒ‡å®šåˆ†æ•°èŒƒå›´å†…çš„æˆå‘˜æ•°é‡

```redis
127.0.0.1:6379> zcount mysort 80 90
(integer) 2
```
  
## Keysçš„é€šç”¨æ“ä½œ

- `KEYS pattern` æŸ¥æ‰¾æ‰€æœ‰ç¬¦åˆç»™å®šæ¨¡å¼ pattern çš„ keyï¼ˆå¦‚ï¼škeys *ï¼‰

### èŽ·å–æ‰€æœ‰key

```redis
127.0.0.1:6379> keys num
1) "num"
127.0.0.1:6379> keys *
 1) "myhash"
 2) "mylist6"
 3) "myb3"
 4) "myb2"
 5) "mya2"
 6) "mylist3"
 7) "num2"
 8) "company"
 9) "mylist5"
10) "my2"
11) "mylist4"
12) "mya3"
13) "mylist2"
14) "num"
15) "myset"
16) "my3"
17) "num5"
18) "num3"
19) "my1"
20) "myb1"
21) "mysort"
22) "mylist"
23) "mya1"
127.0.0.1:6379> keys num*
1) "num2"
2) "num"
3) "num5"
4) "num3"
127.0.0.1:6379> keys num?
1) "num2"
2) "num5"
3) "num3"
```

### åˆ é™¤key

```redis
127.0.0.1:6379> del my1 my2 my3
(integer) 3
```

### æ£€æŸ¥keyæ˜¯å¦å­˜åœ¨

```redis
127.0.0.1:6379> exists my1
(integer) 0
127.0.0.1:6379> exists mya1
(integer) 1
```

### é‡å‘½åkey

```redis
127.0.0.1:6379> rename company newcompany
OK
127.0.0.1:6379> get company
(nil)
127.0.0.1:6379> get newcompany
"tony"
```

### è®¾ç½®keyçš„è¿‡æœŸæ—¶é—´

```redis
127.0.0.1:6379> expire newcompany 1000
(integer) 1
```

### èŽ·å–keyçš„è¿‡æœŸæ—¶é—´

```redis
127.0.0.1:6379> ttl newcompany
(integer) 984
127.0.0.1:6379> ttl mya1
(integer) -1
```

### èŽ·å–keyçš„ç±»åž‹

```redis
127.0.0.1:6379> type mystring
string
127.0.0.1:6379> type myhash
hash
127.0.0.1:6379> type mylist
list
127.0.0.1:6379> type myset
set
127.0.0.1:6379> type mysort
zset
```

## ç‰¹æ€§ï¼šå¤šæ•°æ®åº“

- `SELECT index` åˆ‡æ¢åˆ°æŒ‡å®šçš„æ•°æ®åº“ï¼ˆRedisé»˜è®¤æœ‰16ä¸ªæ•°æ®åº“ï¼Œç¼–å·ä»Ž0å¼€å§‹ï¼Œé»˜è®¤ä½¿ç”¨ç¬¬0ä¸ªæ•°æ®åº“ï¼‰
- `MOVE key db` å°†å½“å‰æ•°æ®åº“ä¸­çš„ key ç§»åŠ¨åˆ°æŒ‡å®šçš„æ•°æ®åº“ db ä¸­
- `FLUSHDB` æ¸…ç©ºå½“å‰æ•°æ®åº“
- `FLUSHALL` æ¸…ç©ºæ‰€æœ‰æ•°æ®åº“

### åˆ‡æ¢æ•°æ®åº“

```redis
127.0.0.1:6379> select 1
OK
127.0.0.1:6379[1]> keys *
(empty array)
127.0.0.1:6379[1]> select 0
OK
127.0.0.1:6379> keys *
 1) "myhash"
 2) "mylist6"
 3) "myb3"
 4) "myb2"
 5) "mya2"
 6) "mylist3"
 7) "num2"
 8) "mylist5"
 9) "mylist4"
10) "mya3"
11) "mylist2"
12) "num"
13) "myset"
14) "newcompany"
15) "num5"
16) "num3"
17) "myb1"
18) "mysort"
19) "mylist"
20) "mya1"
```

### ç§»åŠ¨keyåˆ°æŒ‡å®šæ•°æ®åº“

```redis
127.0.0.1:6379> move myset 1
(integer) 1
127.0.0.1:6379> select 1
OK
127.0.0.1:6379[1]> keys *
1) "myset"
127.0.0.1:6379[1]> type myset
set
```

## ç‰¹æ€§ï¼šRedisäº‹åŠ¡

- `MULTI` æ ‡è®°ä¸€ä¸ªäº‹åŠ¡å—çš„å¼€å§‹
- `EXEC` æ‰§è¡Œæ‰€æœ‰äº‹åŠ¡å—å†…çš„å‘½ä»¤
- `DISCARD` å–æ¶ˆäº‹åŠ¡ï¼Œæ”¾å¼ƒæ‰§è¡Œäº‹åŠ¡å—å†…çš„æ‰€æœ‰å‘½ä»¤
- `WATCH key [key ...]` ç›‘è§†ä¸€ä¸ª(æˆ–å¤šä¸ª) key ï¼Œå¦‚æžœåœ¨äº‹åŠ¡æ‰§è¡Œä¹‹å‰è¿™ä¸ª(æˆ–è¿™äº›) key è¢«å…¶ä»–å‘½ä»¤æ‰€æ”¹åŠ¨ï¼Œé‚£ä¹ˆäº‹åŠ¡å°†è¢«æ‰“æ–­
- `UNWATCH` å–æ¶ˆ WATCH å‘½ä»¤å¯¹æ‰€æœ‰ key çš„ç›‘è§†

### æäº¤äº‹ç‰©

- ç»ˆç«¯1

```redis
127.0.0.1:6379> set num 1
OK
127.0.0.1:6379> get num
"1"
127.0.0.1:6379> get num
"2"
127.0.0.1:6379> multi
OK
127.0.0.1:6379(TX)> incr num
QUEUED
127.0.0.1:6379(TX)> incr num
QUEUED
127.0.0.1:6379(TX)> exec
1) (integer) 3
2) (integer) 4
```

- ç»ˆç«¯2

```redis
127.0.0.1:6379> incr num
(integer) 2
127.0.0.1:6379> get num
"2"
127.0.0.1:6379> get num
"2"
127.0.0.1:6379> get num
"4"
```

### å›žæ»šäº‹ç‰©

```redis
127.0.0.1:6379> set user tom
OK
127.0.0.1:6379> get user
"tom"
127.0.0.1:6379> multi
OK
127.0.0.1:6379(TX)> set user jerry
QUEUED
127.0.0.1:6379(TX)> discard
OK
127.0.0.1:6379> get user
"tom"
```

## RedisæŒä¹…åŒ–

### æ–¹å¼1ï¼šRDBæ–¹å¼æŒä¹…åŒ–

#### é…ç½®ï¼šè‡ªåŠ¨è§¦å‘æŒä¹…åŒ–

```redis
save 900 1
save 300 10
save 60 10000
```

#### é…ç½®ï¼šä¿å­˜æ–‡ä»¶è·¯å¾„

```redis
dbfilename dump.rdb
dir ./
```

### æ–¹å¼2ï¼šAOFæ–¹å¼æŒä¹…åŒ–

#### é…ç½®ï¼šå¼€å¯AOF

```redis
appendonly yes

appendfilename "appendonly.aof"
appenddirname "appendonlydir"

appendfsync always
# appendfsync everysec
# appendfsync no
```

- appendonlyï¼šæ˜¯å¦å¼€å¯AOFæŒä¹…åŒ–ï¼Œé»˜è®¤æ˜¯noï¼Œä¸å¼€å¯
- appendfilenameï¼šAOFæ–‡ä»¶åï¼Œé»˜è®¤æ˜¯appendonly.aof
- appenddirnameï¼šAOFæ–‡ä»¶å­˜æ”¾ç›®å½•ï¼Œé»˜è®¤æ˜¯å½“å‰ç›®å½•
- appendfsyncï¼šAOFæ–‡ä»¶åŒæ­¥ç­–ç•¥ï¼Œé»˜è®¤æ˜¯everysecï¼Œæ¯ç§’åŒæ­¥ä¸€æ¬¡
  - alwaysï¼šæ¯æ¬¡æ‰§è¡Œå†™å…¥æ“ä½œåŽç«‹å³åŒæ­¥
  - everysecï¼šæ¯ç§’åŒæ­¥ä¸€æ¬¡
  - noï¼šä¸è¿›è¡ŒåŒæ­¥

> é»˜è®¤ä¸å¼€å¯ï¼ˆä¹Ÿå°±æ˜¯appendonly noï¼‰ï¼Œä¸å¼€å¯æ—¶Redisé»˜è®¤ä½¿ç”¨RDBæ–¹å¼æŒä¹…åŒ–

- é‡å¯redis-server

```redis
â¯ redis-cli
127.0.0.1:6379> shutdown
not connected>
/opt/homebrew/opt/redis/bin/redis-server /opt/homebrew/etc/redis.conf
```

### æ–¹å¼3ï¼šæ··åˆæŒä¹…åŒ–ï¼ˆåŒæ—¶ä½¿ç”¨RDBå’ŒAOFï¼‰

- é…ç½®ï¼šå¼€å¯AOF

```redis
appendonly yes
```

- é…ç½®ï¼šå¼€å¯æ··åˆæŒä¹…åŒ–

```redis
aof-use-rdb-preamble yes
```

- é‡å¯redis-server

```redis
â¯ redis-cli
127.0.0.1:6379> shutdown
not connected>
/opt/homebrew/opt/redis/bin/redis-server /opt/homebrew/etc/redis.conf
```
